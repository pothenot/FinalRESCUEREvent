(()=>{var e=document.currentScript;define("62cac389-787f-495d-beca-e11786162ef4_1.0.0",["tslib","react","react-dom","@microsoft/sp-core-library","@microsoft/sp-lodash-subset","@microsoft/sp-webpart-base","@microsoft/sp-component-base","@ms/office-ui-fabric-react-bundle","@ms/odsp-utilities-bundle","@ms/sp-component-utilities","@microsoft/sp-loader","@ms/sp-deferred-component","@ms/sp-webpart-shared","@ms/sp-fluentui-migration-customizer-bundle","@ms/sp-fluentui-migration-button-bundle","@microsoft/sp-page-context","@ms/i18n-utilities","@ms/sp-fluentui-migration-reactdom-render-bundle","@microsoft/load-themed-styles"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v)=>(()=>{"use strict";var y,S,D,I={404:(e,t,n)=>{n.d(t,{AN:()=>o,L2:()=>s,Ps:()=>c});var a=n(553),i=n(37),r=n(933),o=function(){function e(){}return e.loadModule=function(){return e._moduleLoadPromise||(e._moduleLoadPromise=i.SPComponentLoader.loadComponentById(e._imageToolsModuleGuid)),e._moduleLoadPromise},e._imageToolsModuleGuid="1e49a922-5650-4595-926f-4d19966e0e67",e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype._internalLoad=function(){return o.loadModule().then(function(e){return e.ActionBar})},t}(r._DeferredComponent),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype._internalLoad=function(){return o.loadModule().then(function(e){return e.FocalPoint})},t}(r._DeferredComponent)}
,436:(e,t,n)=>{n.d(t,{IA:()=>d,L$:()=>l,c7:()=>o,ce:()=>c,fJ:()=>s,iG:()=>i,ly:()=>r});var a=n(878);function i(){return a._SPKillSwitch.isActivated("d07ff502-2094-4eb0-8ff7-e99643da4639")}function r(){return a._SPFlight.isEnabled(60803)}function o(){return a._SPKillSwitch.isActivated("7c1a2042-7bcb-40f1-be82-6dadef2da417")}function s(){return a._SPFlight.isEnabled(1342)}function c(){return a._SPKillSwitch.isActivated("740c7407-a958-4e0f-9652-7af51c6697ef")}function d(){return a._SPKillSwitch.isActivated("eddf8ee2-6c91-4e9a-b18b-611ed06a3303")}function l(){return a._SPKillSwitch.isActivated("2955992f-ba26-48c7-a8b7-dcbeb4df28d9")}}
,88:(e,t,n)=>{n.d(t,{q:()=>i,r:()=>a});var a={CountUp:"COUNT_UP",CountDown:"COUNT_DOWN"},i={DayOnly:"DAY_ONLY",DayHourMinute:"DAY_HOUR_MINUTE",DayHourMinuteSecond:"DAY_HOUR_MINUTE_SECOND"}}
,293:(e,t,n)=>{function a(e,t,n){void 0===t&&(t="0"),void 0===n&&(n=2);var a=e.toString(),i=n-a.length;if(i<=0)return a;for(var r=a,o=0;o<i;o++)r=t+r;return r}n.d(t,{Q:()=>a})}
,859:(e,t,n)=>{n.d(t,{NZ:()=>l,nY:()=>c,oN:()=>d});var a=n(171),i=n(878),r=n(111),o=n(687),s=n(293);function c(e,t){var n=e.convertToUTC(t);return Date.UTC(n.fullYear,n.month,n.date,n.hours,n.minutes,n.seconds,n.milliseconds)}function d(e,t){var n=function(e){var t=new Date(e);return new r.SPDate({fullYear:t.getUTCFullYear(),month:t.getUTCMonth(),date:t.getUTCDate(),hours:t.getUTCHours(),minutes:t.getUTCMinutes(),seconds:t.getUTCSeconds(),milliseconds:t.getUTCMilliseconds()})}(e);return n.convertFromUTC(t)}function l(e){var t=-1*e/60,n=-1*e%60,r=(t>0?"+":"")+"".concat(t,":").concat((0,s.Q)(n));return new a.SPTimeZone({daylightDate:{Year:0,Month:0,DayOfWeek:0,Day:0,Hour:0,Minute:0,Second:0,Milliseconds:0},daylightOffset:0,description:i.Text.format(o.rh,r),id:0,offset:e,standardDate:{Year:0,Month:0,DayOfWeek:0,Day:0,Hour:0,Minute:0,Second:0,Milliseconds:0},standardOffset:0})}}
,230:e=>{e.exports=v},866:e=>{e.exports=s},878:e=>{e.exports=i},37:e=>{e.exports=u},348:e=>{e.exports=r},171:e=>{e.exports=h},134:e=>{e.exports=o},111:e=>{e.exports=b},616:e=>{e.exports=d},79:e=>{e.exports=c},962:e=>{e.exports=l},933:e=>{e.exports=f},8:e=>{e.exports=_},559:e=>{e.exports=m},541:e=>{e.exports=g},709:e=>{e.exports=p},650:e=>{e.exports=n},729:e=>{e.exports=a},553:e=>{e.exports=t},687:e=>{e.exports=JSON.parse('{"V6":"Date and time","Ut":"Time selection","sn":"days","Hv":"hours","kM":"minutes","ZH":"seconds","i_":"days","fH":"hrs","zH":"min","Hh":"sec","h6":"Call to action text","Wt":"Call to action link","c2":"Display timer as","hW":"Days","aV":"Days, hours, minutes","As":"Days, hours, minutes, seconds","iH":"Call to action text required.","g8":"Call to action link required.","rh":"Can\\u0027t find a SharePoint time zone, so using your computer time setting (for example, UTC{0}).","wW":"Learn how to change your personal language and region settings.","mM":"Enter a time that looks like 7:45 PM (standard) or 19:45 (24-hour).","K9":"Add a title","Lo":"Title field.","cf":"Add a description","J0":"Description field.","Ze":"Call to action","sR":"Call to action","Ry":"On","QI":"Off","bk":"Call to action toggle is on.","pu":"Call to action toggle is off.","fh":"Background image","GL":"Add","B_":"Change","tG":"Remove","Fm":"Add a background image.","UP":"Change the background image.","Cd":"Remove the background image.","yJ":"Overlay color","Je":"A semitransparent color overlay is added to help with text legibility.","b0":"Overlay opacity","g3":"Dark color overlay.","Pn":"Light color overlay.","Jy":"Uploading image...","Tl":"Adding overlay to help with legibility..."}')}
},x={};function C(e){var t=x[e];if(void 0!==t)return t.exports;var n=x[e]={exports:{}};return I[e](n,n.exports,C),n.exports}C.m=I,C.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return C.d(t,{a:t}),t},C.d=(e,t)=>{for(var n in t)C.o(t,n)&&!C.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},C.f={},C.e=e=>Promise.all(Object.keys(C.f).reduce((t,n)=>(C.f[n](e,t),t),[])),C.u=e=>"chunk."+(30===e?"countdown-property-pane-templates":e)+"_none_"+{9:"02adfbda3e4329a9ccc2",30:"11cbe4ee30516e2e97b7"}[e]+".js",C.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),y={},S="62cac389-787f-495d-beca-e11786162ef4_1.0.0:",C.l=(e,t,n,a)=>{if(y[e])y[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==S+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,C.nc&&i.setAttribute("nonce",C.nc),i.setAttribute("data-webpack",S+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),y[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=y[e];if(delete y[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},C.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},D=e?e.src:"",C.p=D.slice(0,D.lastIndexOf("/")+1),C.f.compat=(e,t)=>{for(var n=function(e){return{9:[{i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.14",m:853}],30:[{i:"f9e737b7-f0df-4597-ba8c-3060f82380db",v:"1.20.0",m:723},{i:"ffe5c101-373a-4bd2-bebb-13082852bab0",v:"0.1.0",m:488},{i:"4d07cf21-ab46-427b-a01f-1f96fe970a01",v:"0.1.0",m:932},{i:"2c46c8f0-e214-4f49-951e-fd5b9d7b4ae1",v:"1.20.0",m:137},{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:656},{i:"bc9242cf-c4f7-4ff8-a1f4-93ae4da35b7f",v:"0.1.0",m:763},{i:"89f063a9-3b5f-4ac2-a3ec-b598f37acb89",v:"0.1.0",m:785},{i:"215395c1-25f7-42ff-967c-8832aff2ab33",v:"0.1.0",m:306},{i:"91976643-f860-4be9-ba8f-32b82339a0ca",v:"0.1.0",m:326}]}[e]||[]}(e),a=0;a<n.length;a++)C.m[n[a].m]||(e=>{t.push(O.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{C.m[e.m]=e=>e.exports=t}))})(n[a])};var O=C(37);(()=>{var e={671:0};C.f.j=(t,n)=>{var a=C.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=C.p+C.u(t),o=new Error;C.l(r,n=>{if(C.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)C.o(o,a)&&(C.m[a]=o[a]);s&&s(C)}for(t&&t(n);c<r.length;c++)i=r[c],C.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_62cac389-787f-495d-beca-e11786162ef4_1.0.0"]=self["webpackJsonp_62cac389-787f-495d-beca-e11786162ef4_1.0.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var w={};return(()=>{C.r(w),C.d(w,{default:()=>te});var e=C(553),t=C(650),n=C(541),a=C(729),i=C(878),r=C(348),o=C(134),s=C(866),c=C(79),d=C(88),l="EXTRA_SMALL",u="MEDIUM",f="LARGE",p="NO_OVERLAY",m="LIGHT_OVERLAY",_="DARK_OVERLAY",h=(0,c.classNamesFunction)(),b=function(e){var t,n=e.overlayType,a=e.variantTheme,i=e.width,r=(0,c.getTheme)(),o=r.semanticColors.bodyText;switch(n===m?o="#333333":n===_&&(o="#ffffff"),i){case f:t="56px 40px";break;case u:t="35px";break;default:t="40px 24px"}return{container:{backgroundColor:r.palette.white,borderColor:a?a.semanticColors.variantBorder:r.semanticColors.variantBorder,borderStyle:"solid",borderWidth:n===p?1:0,color:o,overflow:"hidden",position:"relative",textAlign:"center"},content:{padding:t}}},g=C(293);function v(e,t){var n=t.valueOf()-e.valueOf();if(n<=0)return{daysRemaining:0,hoursRemaining:0,minutesRemaining:0,secondsRemaining:0};var a=Math.floor(n/864e5),i=Math.floor(n%864e5/36e5),r=Math.floor(n%36e5/6e4),o=Math.round(n%6e4/1e3);return 60===(o=Math.floor(o))&&(o=0,r++),60===r&&(r=0,i++),24===i&&(i=0,a++),{daysRemaining:a,hoursRemaining:i,minutesRemaining:r,secondsRemaining:o}}var y=C(616),S=C(962),D=C(404),I=C(436),x=(0,c.classNamesFunction)(),O=function(e){var t=e.containerHeight,n=e.containerWidth,a=e.backgroundImageUrl,i=e.imageWidthFactor,r=e.isSettingFocalPoint,o=e.overlay,s=e.focalPoint,c=e.imageScale,d={background:"transparent"},l={background:"transparent"};if(a){s||(s={x:50,y:50}),c||(c=1);var u="".concat(s.x,"% ").concat(s.y,"%"),f="".concat(100*c,"%");t&&n&&i&&i>n/t&&(f="auto ".concat(f)),d={backgroundImage:(0,I.IA)()?"url(".concat(a,")"):'url("'.concat(a,'")'),backgroundPosition:u,backgroundRepeat:"no-repeat",backgroundSize:f,transition:"background-image 500ms ease-in-out, background-size 200ms linear",selectors:{"div[class^='focalFrame']":{position:"absolute"}}}}if(o){var p=o.color,m=parseInt(p.substr(1,2),16),_=parseInt(p.substr(3,2),16),h=parseInt(p.substr(5,2),16),b=o.opacity;l={backgroundColor:"rgba(".concat(m,", ").concat(h,", ").concat(_,", ").concat(b/100,")"),opacity:r?0:1,transition:"background-color 250ms ease-in-out"}}return{imageContainer:d,overlayLayer:l}};function E(e){return new Promise(function(t,n){if(e){var a=new Image;a.onload=function(){return t()},a.onerror=function(){return n()},a.src=e}else n()})}var A={x:50,y:50},L=function(n){function a(e){var t=n.call(this,e)||this;t._handleSetFocalPoint=function(){t.setState({isSettingFocalPoint:!0})},t._handleFocalPointMove=function(e){t.setState({focalPosition:e})},t._handleFocalPointEnd=function(){t.setState({isSettingFocalPoint:!1}),t.props.onFocalPointChanged(t.state.focalPosition)},t._handleImageChanged=function(e){t.props.onImageChanged(e)},t._hideActionBar=function(){t.setState({showActionBar:!1})},t._showActionBar=function(){t.setState({showActionBar:!0})},t._getPreviewUrl=function(e){if(S.ThumbnailUrlGenerator.isVROOMThumbnailEnabled()&&e.id&&e.siteId&&e.webId){var n=new y.Uri(t.props.absoluteUrl),a=S.PreviewUtility.getVROOMItemUrl(e.siteId,e.webId,e.listId,e.id,n.getLeftPart(1),n.getAuthority());if(!a)return;return S.PreviewUtility.getVROOMThumbnailUrl(a,window.innerWidth)}var i=S.ExtensionHelper.getExtension(e.url)||"";return S.PreviewHelper.getPreviewImageUrl(i,void 0,t.props.absoluteUrl,e.url,e.siteId,e.webId,e.id,window.innerWidth,!1,"countdownBackgroundContainer")};var a=!!e.image&&!!e.image.focalPosition;return t.state={backgroundImageUrl:t.props.image?t.props.image.url:void 0,focalPosition:a?e.image.focalPosition:A,isSettingFocalPoint:!1,showActionBar:!1},t}return(0,e.__extends)(a,n),a.prototype.componentDidMount=function(){var e=this.props.image;e&&this._updateBackgroundImageUrl(e)},a.prototype.shouldComponentUpdate=function(e){var t=!this.props.image&&!!e.image,n=!!this.props.image&&!!e.image&&this.props.image.url!==e.image.url,a=!!this.props.image&&!e.image;return(t||n)&&this.setState({focalPosition:A}),(n||t||a)&&this._updateBackgroundImageUrl(e.image),!0},a.prototype.componentDidUpdate=function(e,t){var n=this;this.state.isSettingFocalPoint&&t.isSettingFocalPoint&&D.AN.loadModule().then(function(e){return e.FocalPoint.focus(n._containerComponent||null)})},a.prototype.render=function(){var e=this.props,n=e.image,a=e.hasActionBar,i=e.isEditing,r=e.onEditButtonClicked,o=this.state,s=o.isSettingFocalPoint,c=o.showActionBar,d=this._classNames;return t.createElement("div",{className:d.imageContainer,onBlur:this._hideActionBar,onFocus:this._showActionBar,onMouseEnter:this._showActionBar,onMouseLeave:this._hideActionBar,ref:this._resolveRef("_containerComponent")},s&&t.createElement(D.Ps,{deferredProps:{position:this.state.focalPosition,onFocalPointEnd:this._handleFocalPointEnd,onFocalPointMove:this._handleFocalPointMove}}),t.createElement("div",{className:d.overlayLayer},this.props.children),a&&i&&n&&t.createElement(D.L2,{deferredProps:{itemId:n.id,imageItem:n,hasMoveButton:!1,hidden:s||!c,isSettingFocalPoint:!1,reverseRow:!1,onEdit:r,onSetZoomFactor:this._handleImageChanged,onSetFocalPoint:this._handleSetFocalPoint}}))},Object.defineProperty(a.prototype,"_classNames",{get:function(){var e=this.props,t=e.image,n=e.overlay,a={backgroundImageUrl:this.state.backgroundImageUrl,containerHeight:this._containerComponent?this._containerComponent.clientHeight:void 0,containerWidth:this._containerComponent?this._containerComponent.clientWidth:void 0,imageScale:t&&t.zoomRatio,imageWidthFactor:t&&t.widthFactor,isSettingFocalPoint:this.state.isSettingFocalPoint,focalPoint:this.state.focalPosition,overlay:n};return x(O,a)},enumerable:!1,configurable:!0}),a.prototype._updateBackgroundImageUrl=function(e){var t=this;if(e){e.webId&&0!==e.webId.length||(e.webId=this.props.webId);var n=function(){E(e.url).then(function(){return t.setState({backgroundImageUrl:e.url})}).catch(function(){return console.error("Error loading image",e.url)})},a=this._getThumbnailUrl(e);E(a).then(function(){return t.setState({backgroundImageUrl:a})}).catch(function(){var a=t._getPreviewUrl(e);E(a).then(function(){return t.setState({backgroundImageUrl:a})}).catch(n)})}else this.setState({backgroundImageUrl:void 0})},a.prototype._getThumbnailUrl=function(e){var t=S.ExtensionHelper.getExtension(e.url)||"";return S.ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:this.props.absoluteUrl,spResource:decodeURI(e.url),siteId:e.siteId,webId:e.webId,listId:e.listId,uniqueId:e.id,fileType:t,width:window.innerWidth,callerId:"countdownBackgroundContainer"})},a}(c.BaseComponent),k=C(559),M=C(8),P=C(709),T=C(687),U=(0,c.classNamesFunction)(),F=function(e){var t=e.isPlaceholder,n=(0,c.getTheme)();return{callToActionButton:{"&.callToActionButton":{backgroundColor:n.semanticColors.primaryButtonBackground,color:n.semanticColors.primaryButtonText,display:"inline-block",opacity:t?.75:1}}}},H=function(e,t,n){return{".ms-Fabric--isFocusVisible &:focus::after":{border:"1px solid ".concat(e),borderRadius:t,inset:"0",outline:"2px solid ".concat(n)}}};function R(t){var n=t.theme,a=t.primary;return(0,c.concatStyleSets)(function(e){return{root:{paddingLeft:"12px",paddingRight:"12px",borderRadius:e.effects.roundedCorner4}}}(n),a?function(t){var n=t.effects,a=t.palette,i=t.semanticColors;return{root:(0,e.__assign)((0,e.__assign)({backgroundColor:i.primaryButtonBackground,borderColor:i.primaryButtonBorder,color:i.primaryButtonText},H(a.white,n.roundedCorner4,i.focusBorder)),{".ms-Fabric--isFocusVisible &:focus":{"@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)":{outline:"2px solid buttontext"}}}),rootHovered:{backgroundColor:i.primaryButtonBackgroundHovered,borderColor:i.primaryButtonBackgroundHovered,color:i.primaryButtonTextHovered},rootPressed:{backgroundColor:i.primaryButtonBackgroundPressed,borderColor:i.primaryButtonBackgroundPressed,color:i.primaryButtonTextPressed},rootDisabled:{backgroundColor:i.primaryButtonBackgroundDisabled,borderColor:i.primaryButtonBackgroundDisabled,color:i.primaryButtonTextDisabled}}}(n):function(t){var n=t.effects,a=t.palette,i=t.semanticColors;return{root:(0,e.__assign)({borderColor:i.buttonBorder,color:i.buttonText},H("transparent",n.roundedCorner4,i.focusBorder)),rootHovered:{backgroundColor:i.buttonBackgroundHovered,borderColor:a.neutralTertiaryAlt,color:i.buttonTextHovered},rootPressed:{backgroundColor:i.buttonBackgroundPressed,borderColor:a.neutralTertiary,color:i.buttonTextPressed},rootDisabled:{backgroundColor:i.buttonBackgroundDisabled,borderColor:i.buttonBorderDisabled,color:i.buttonTextDisabled}}}(n))}const N=function(n){function a(){var a=null!==n&&n.apply(this,arguments)||this;return a._renderCustomizerWrapper=function(){var n={scopedSettings:{DefaultButton:{styles:R}}};return t.createElement(k.Customizer,(0,e.__assign)({},n),a._renderPrimaryButton())},a._renderPrimaryButton=function(){var e=a.props,n=e.isEditing,i=e.text,r=e.url,o=a._classNames;return t.createElement(M.PrimaryButton,{className:"".concat(o.callToActionButton," callToActionButton"),disabled:n,href:r,target:(0,P.getUrlTarget)(r)},""===i?T.Ze:i)},a}return(0,e.__extends)(a,n),a.prototype.render=function(){var e=this.props,t=e.showButton,n=e.text,a=e.url,i=t&&""!==a&&""!==n||this._isPlaceholder;return i&&(0,I.ly)()?this._renderCustomizerWrapper():i&&this._renderPrimaryButton()},Object.defineProperty(a.prototype,"_isPlaceholder",{get:function(){var e=this.props,t=e.isEditing,n=e.showButton,a=e.text,i=e.url;return t&&n&&(""===i||""===a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"_classNames",{get:function(){var e={variantTheme:this.props.emphasisTheme,isPlaceholder:this._isPlaceholder};return U(F,e)},enumerable:!1,configurable:!0}),a}(t.PureComponent);var B=(0,c.classNamesFunction)(),j=function(e){return{timeContainer:{display:"flex",justifyContent:"center",marginTop:0,marginLeft:-40,marginRight:-40,marginBottom:e.width===f?40:32}}},V=(0,c.classNamesFunction)(),z=function(e){var t,n,a,i,r=e.overlayType,o=e.width,s=(0,c.getTheme)(),d=s.semanticColors.bodyText,p=s.semanticColors.bodySubtext;switch(o){case f:t=80,n=c.FontSizes.mediumPlus,i="0 20px",a=90;break;case u:t=48,n=c.FontSizes.medium,i="0 12px",a=56;break;case!(0,I.iG)()&&l:t=28,n=c.FontSizes.small,i="0 8px",a=36;break;default:t=32,n=c.FontSizes.small,i="0 12px",a=40}return r===m?d=p="#333333":r===_&&(d=p="#ffffff"),{digit:{color:d,fontSize:t,fontWeight:c.FontWeights.regular},label:{color:p,display:"block",fontSize:n,padding:0,textAlign:"center"},timePart:{margin:i,minWidth:a}}};const G=function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return(0,e.__extends)(a,n),a.prototype.render=function(){var e=this.props,n=e.digitValue,a=e.label,i=e.labelAbbreviation,r=e.useAbbreviations,o=this._classNames;return t.createElement("div",{className:o.timePart},t.createElement("span",{className:o.digit},n),t.createElement("span",{className:o.label},r?i:a))},Object.defineProperty(a.prototype,"_classNames",{get:function(){var e={overlayType:this.props.overlayType,width:this.props.width,variantTheme:this.props.emphasisTheme};return V(z,e)},enumerable:!1,configurable:!0}),a}(t.PureComponent),K=function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return(0,e.__extends)(a,n),a.prototype.render=function(){var n=this.props,a=n.displayHours,i=n.displayMinutes,r=n.displaySeconds,o=n.daysRemaining,s=n.emphasisTheme,c=n.hoursRemaining,d=n.minutesRemaining,l=n.overlayType,u=n.secondsRemaining,f={emphasisTheme:s,overlayType:l,useAbbreviations:n.useAbbreviations,width:n.width},p=this._classNames;return t.createElement("div",{className:p.timeContainer},t.createElement(G,(0,e.__assign)({},f,{digitValue:o,label:T.sn,labelAbbreviation:T.i_})),a&&t.createElement(G,(0,e.__assign)({},f,{digitValue:c,label:T.Hv,labelAbbreviation:T.fH})),i&&t.createElement(G,(0,e.__assign)({},f,{digitValue:d,label:T.kM,labelAbbreviation:T.zH})),r&&t.createElement(G,(0,e.__assign)({},f,{digitValue:u,label:T.ZH,labelAbbreviation:T.Hh})))},Object.defineProperty(a.prototype,"_classNames",{get:function(){var e={variantTheme:this.props.emphasisTheme,width:this.props.width};return B(j,e)},enumerable:!1,configurable:!0}),a}(t.PureComponent);var W=(0,c.classNamesFunction)(),q=function(e){var t,n,a=e.overlayType,i=e.width,r=(0,c.getTheme)(),o=c.FontWeights.regular,s=r.semanticColors.bodyText,d=r.palette.neutralSecondary,p=r.palette.neutralSecondary,h=r.palette.neutralDark;switch(i){case f:t=r.fonts.large.fontSize,n=40;break;case u:t=r.fonts.mediumPlus.fontSize,n=32;break;case!(0,I.iG)()&&l:t=r.fonts.smallPlus.fontSize,n=28;break;default:t=r.fonts.medium.fontSize,n=32}return a===m?(d="#666666",s="#333333",h="#212121",p="#666666"):a===_&&(d="#eaeaea",s="#ffffff",h="#f8f8f8",p="#d0d0d0"),{description:{color:s,display:"block",fontWeight:o,minHeight:"1.5em",maxWidth:1204,marginLeft:"auto",marginRight:"auto",textAlign:"center",whiteSpace:"pre-wrap",selectors:{'[class*="fieldGroup"]':{background:"transparent",minHeight:"auto"}},fontSize:t,marginBottom:n},descriptionInput:{color:s,fontWeight:o,height:"1.5em",lineHeight:"1.5em",resize:"none",textAlign:"center !important",whiteSpace:"pre-wrap",selectors:{"::placeholder, ::-webkit-input-placeholder, ::-ms-input-placeholder":{color:p,fontWeight:o,fontSize:t},":hover":{borderBottomColor:d,borderBottomStyle:"solid",borderBottomWidth:1},":active, :focus":{borderBottomColor:r.palette.themePrimary,borderBottomStyle:"solid",borderBottomWidth:1},":active, :focus, :hover":{selectors:{"::placeholder":{color:h}}}},fontSize:t}}};const Q=function(n){function a(){var e=null!==n&&n.apply(this,arguments)||this;return e._onTextFieldChange=function(t,n){e.props.onChanged(n||"")},e}return(0,e.__extends)(a,n),a.prototype.render=function(){var e=this.props,n=e.isEditing,a=e.text,i=this._classNames;return n?t.createElement(c.TextField,{ariaLabel:T.J0,autoAdjustHeight:!0,borderless:!0,className:i.description,inputClassName:i.descriptionInput,multiline:!0,placeholder:T.cf,value:a,onChange:this._onTextFieldChange}):t.createElement("span",{className:i.description},a)},Object.defineProperty(a.prototype,"_classNames",{get:function(){var e={overlayType:this.props.overlayType,variantTheme:this.props.emphasisTheme,width:this.props.width};return W(q,e)},enumerable:!1,configurable:!0}),a}(t.PureComponent);var Y=(0,c.classNamesFunction)(),J=function(e){var t,n,a=e.overlayType,i=e.width,r=(0,c.getTheme)(),o=r.semanticColors.bodyText,s=r.palette.neutralSecondary,d=r.palette.neutralSecondary,p=r.palette.neutralDark;switch(i){case f:t=r.fonts.xxLarge.fontSize,n=32;break;case u:t=24,n=16;break;case!(0,I.iG)()&&l:t=r.fonts.large.fontSize,n=16;break;default:t=r.fonts.xLarge.fontSize,n=16}return a===m?(s="#666666",o="#333333",p="#212121",d="#666666"):a===_&&(s="#eaeaea",o="#ffffff",p="#f8f8f8",d="#d0d0d0"),{title:{alignItems:"center",color:o,display:"flex",fontWeight:c.FontWeights.semibold,justifyContent:"space-around",marginLeft:"auto",marginRight:"auto",maxWidth:1204,textAlign:"center",whiteSpace:"pre-wrap",wordWrap:"break-word",fontSize:t,marginBottom:n},titleField:{marginBottom:"0.6em",marginLeft:"auto",marginRight:"auto",maxWidth:1204,minHeight:"1.5em",padding:0,fontSize:t,selectors:{'[class*="fieldGroup"]':{background:"transparent",minHeight:"auto"}}},titleInputField:{color:o,fontWeight:c.FontWeights.semibold,height:"1.5em",lineHeight:"1.5em",resize:"none",textAlign:"center",selectors:{"::placeholder, ::-webkit-input-placeholder, ::-ms-input-placeholder":{color:d,fontWeight:c.FontWeights.semibold,fontSize:t},":hover":{borderBottomColor:s,borderBottomStyle:"solid",borderBottomWidth:1},":active, :focus":{borderBottomColor:r.palette.themePrimary,borderBottomStyle:"solid",borderBottomWidth:1},":active, :focus, :hover":{selectors:{"::placeholder":{color:p}}}},fontSize:t,marginBottom:n}}};const X=function(n){function a(){var e=null!==n&&n.apply(this,arguments)||this;return e._onTextFieldChange=function(t,n){e.props.onChanged(n||"")},e}return(0,e.__extends)(a,n),a.prototype.render=function(){var e=this.props,n=e.isEditing,a=e.text,i=this._classNames;return n?t.createElement(c.TextField,{ariaLabel:T.Lo,autoAdjustHeight:!0,borderless:!0,className:i.titleField,inputClassName:i.titleInputField,maxLength:110,multiline:!0,placeholder:T.K9,value:a,onChange:this._onTextFieldChange}):t.createElement("h2",{className:i.title},a)},Object.defineProperty(a.prototype,"_classNames",{get:function(){var e={overlayType:this.props.overlayType,variantTheme:this.props.emphasisTheme,width:this.props.width};return Y(J,e)},enumerable:!1,configurable:!0}),a}(t.PureComponent);function Z(e){return e?e.useLightText?_:m:p}const $=function(n){function a(t){var a=n.call(this,t)||this;return a._updateWidth=function(){a.setState({useAbbreviations:a.props.width!==f})},a._tickSecond=function(){var t,n=new Date(a.props.countDate);t=a.props.countDirection===d.r.CountDown?v(new Date(Date.now()),n):v(n,new Date(Date.now()));var i=(0,e.__assign)((0,e.__assign)({},a.state),{daysRemaining:(0,g.Q)(t.daysRemaining),hoursRemaining:(0,g.Q)(t.hoursRemaining),minutesRemaining:(0,g.Q)(t.minutesRemaining),secondsRemaining:(0,g.Q)(t.secondsRemaining)});a.setState(i),0===t.daysRemaining&&0===t.hoursRemaining&&0===t.minutesRemaining&&0===t.secondsRemaining&&void 0!==a._tickInterval&&(clearInterval(a._tickInterval),a._tickInterval=void 0)},a._startTimer=function(){if(void 0===a._tickInterval){var e=1e3-(new Date).getMilliseconds();setTimeout(function(){a._tickInterval=window.setInterval(a._tickSecond,1e3)},e)}},a._handleFocalPointEnd=function(e){var t=a.props.backgroundImage;t.focalPosition=e,a.props.onBackgroundImageChanged(t)},a.state={daysRemaining:"00",hoursRemaining:"00",position:t.backgroundImage?t.backgroundImage.focalPosition:void 0,minutesRemaining:"00",secondsRemaining:"00",useAbbreviations:!1},a}return(0,e.__extends)(a,n),a.prototype.componentDidUpdate=function(e){e.countDate===this.props.countDate&&e.countDirection===this.props.countDirection||(this._tickSecond(),this._startTimer()),e.width!==this.props.width&&this._updateWidth()},a.prototype.componentDidMount=function(){this._tickSecond(),this._startTimer(),this._updateWidth()},a.prototype.componentWillUnmount=function(){this._tickInterval&&clearInterval(this._tickInterval)},a.prototype.render=function(){var e=this.state,n=e.daysRemaining,a=e.hoursRemaining,i=e.minutesRemaining,r=e.secondsRemaining,o=e.useAbbreviations,s=this.props,c=s.backgroundImage,d=s.backgroundOverlay,l=s.buttonText,u=s.buttonURL,f=s.displayHours,p=s.displayMinutes,m=s.displaySeconds,_=s.description,h=s.emphasisTheme,b=s.isEditing,g=s.showCallToAction,v=s.title,y=s.webId,S=s.width,D=s.onBackgroundImageChanged,I=s.onDescriptionChanged,x=s.onEditBackgroundImage,C=s.onTitleChanged,O=this._getClassNames(this.props),w=Z(d);return t.createElement("div",{className:O.container},t.createElement(L,{absoluteUrl:this.props.absoluteUrl,image:c,hasActionBar:!0,isEditing:b,overlay:d,webId:y,onEditButtonClicked:x,onFocalPointChanged:this._handleFocalPointEnd,onImageChanged:D},t.createElement("div",{className:O.content},t.createElement(X,{emphasisTheme:h,overlayType:w,isEditing:b,text:v,width:S,onChanged:C}),t.createElement(K,{daysRemaining:n,displayHours:f,displayMinutes:p,displaySeconds:m,emphasisTheme:h,hoursRemaining:a,minutesRemaining:i,overlayType:w,secondsRemaining:r,useAbbreviations:o,width:S}),t.createElement(Q,{emphasisTheme:h,overlayType:w,isEditing:b,text:_,width:S,onChanged:I}),t.createElement(N,{emphasisTheme:h,isEditing:b,showButton:g,text:l,url:u}))))},a.prototype._getClassNames=function(e){var t={overlayType:Z(e.backgroundOverlay),width:e.width,variantTheme:e.emphasisTheme};return h(b,t)},(0,e.__decorate)([c.memoize],a.prototype,"_getClassNames",null),a}(t.Component);var ee=C(859);const te=function(o){function c(){var e=null!==o&&o.apply(this,arguments)||this;return e._onBackgroundEdit=function(){e.context.propertyPane.open(),e.render()},e._onTitleChanged=function(t){e._onCustomPropertyFieldChanged("title",t)},e._onDescriptionChanged=function(t){e._onCustomPropertyFieldChanged("description",t)},e._onBackgroundImageChanged=function(t){e._onCustomPropertyFieldChanged("backgroundImage",t)},e}return(0,e.__extends)(c,o),c.prototype.render=function(){var e=!1,a=!1,r=!1,o=!1;switch(this.properties.dateDisplay){case d.q.DayOnly:a=!0;break;case d.q.DayHourMinute:a=!0,e=!0,r=!0;break;case d.q.DayHourMinuteSecond:default:a=!0,e=!0,r=!0,o=!0}var s=t.createElement($,{absoluteUrl:this.context.pageContext.site.absoluteUrl,backgroundImage:this.properties.backgroundImage,backgroundOverlay:this.properties.backgroundOverlay,buttonText:this.properties.buttonText,buttonURL:this.properties.buttonURL,countDate:this.properties.countDate,countDirection:this.properties.countDirection,dateDisplay:this.properties.dateDisplay,description:this.properties.description,displayDays:a,displayHours:e,displayMinutes:r,displaySeconds:o,emphasisTheme:this._emphasisTheme,isEditing:this.displayMode===i.DisplayMode.Edit,showCallToAction:this.properties.showButton,title:this.properties.title,webId:this.context.pageContext.web.id.toString(),width:this._webPartWidth,onBackgroundImageChanged:this._onBackgroundImageChanged,onDescriptionChanged:this._onDescriptionChanged,onEditBackgroundImage:this._onBackgroundEdit,onTitleChanged:this._onTitleChanged});n.render(s,this.domElement)},Object.defineProperty(c.prototype,"dataVersion",{get:function(){return i.Version.parse("2.1")},enumerable:!1,configurable:!0}),c.prototype.loadPropertyPaneResources=function(){var e=this;return Promise.all([C.e(9),C.e(30)]).then(C.bind(C,658)).then(function(t){var n=t.buildPropertyPaneConfiguration;e.getPropertyPaneConfiguration=function(){return n(e.properties,e.context.pageContext.cultureInfo.currentCultureName,e._serviceScope,e.context.pageContext.site.id.toString(),e.context.pageContext.web.id.toString(),e._timeZone,e._shouldUse24HourTime,e._onCustomPropertyFieldChanged.bind(e))}})},Object.defineProperty(c.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},"backgroundImage.url":{isImageSource:!0},buttonURL:{isLink:!0}}},enumerable:!1,configurable:!0}),c.prototype.onAfterDeserialize=function(e,t){return t.lessThan(i.Version.parse("2.0"))&&(e.showButton=!1),e},c.prototype.onAfterResize=function(e){var t=this._getWidthSize(e);this._webPartWidth!==t&&(this._webPartWidth=t,this.render())},c.prototype.onInit=function(){return this._serviceScope=this.context.serviceScope,this._webPartWidth=this._getWidthSize(this.width),this._setDefaultProperties(),this._getEmphasisTheme(),o.prototype.onInit.call(this)},c.prototype.onDispose=function(){a.unmountComponentAtNode(this.domElement)},Object.defineProperty(c.prototype,"_shouldUse24HourTime",{get:function(){return this.context.pageContext.user.preferUserTimeZone?this.context.pageContext.legacyPageContext.userTime24:this.context.pageContext.legacyPageContext.webTime24},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"_timeZone",{get:function(){return void 0===this.context.pageContext.web.timeZoneInfo&&void 0===this.context.pageContext.user.timeZoneInfo?(0,ee.NZ)((new Date).getTimezoneOffset()):void 0!==this.context.pageContext.user.timeZoneInfo&&this.context.pageContext.user.preferUserTimeZone?this.context.pageContext.user.timeZoneInfo:this.context.pageContext.web.timeZoneInfo},enumerable:!1,configurable:!0}),c.prototype._getWidthSize=function(e){return!(0,I.iG)()&&e<300?l:e<400?"SMALL":e<800?u:f},c.prototype._onCustomPropertyFieldChanged=function(e,t){(0,r.update)(this.properties,e,function(){return t}),this.render()},c.prototype._setDefaultProperties=function(){if(!this.properties.countDate){var e=new Date(Date.now()+864e5);e.setMinutes(0),e.setSeconds(0),this.properties.countDate=e.toString()}this.properties.title=this.properties.title||"",this.properties.description=this.properties.description||"",this.properties.countDirection=this.properties.countDirection||d.r.CountDown,this.properties.dateDisplay=this.properties.dateDisplay||d.q.DayHourMinuteSecond,this.properties.buttonText=this.properties.buttonText||"",this.properties.buttonURL=this.properties.buttonURL||"",void 0===this.properties.showButton&&(this.properties.showButton=!1)},c.prototype._getEmphasisTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(s.ThemeProvider.serviceKey);e._emphasisTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,function(t){e._emphasisTheme=t.theme,e.render()})})},c}(o.BaseClientSideWebPart)})(),w})())})();