(()=>{var e=document.currentScript;define("c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0",["@microsoft/sp-diagnostics","@microsoft/sp-loader","tslib","react","@microsoft/sp-core-library","@ms/sp-component-utilities","@microsoft/sp-http","@microsoft/sp-page-context","@ms/odsp-utilities-bundle","@ms/office-ui-fabric-react-bundle","@ms/sp-telemetry","@microsoft/load-themed-styles","react-dom","@microsoft/sp-webpart-base","@microsoft/sp-property-pane","@ms/sp-fluentui-migration-reactdom-render-bundle","@ms/sp-fluentui-migration-spinner-bundle","@ms/sp-fluentui-migration-label-bundle","@ms/sp-fluentui-migration-tooltip-bundle","@ms/sp-fluentui-migration-button-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y)=>(()=>{"use strict";var S,D,I,x={230:e=>{e.exports=f},878:e=>{e.exports=r},377:e=>{e.exports=t},272:e=>{e.exports=s},37:e=>{e.exports=n},171:e=>{e.exports=c},723:e=>{e.exports=_},134:e=>{e.exports=m},616:e=>{e.exports=d},79:e=>{e.exports=l},962:e=>{e.exports=o},8:e=>{e.exports=y},488:e=>{e.exports=g},541:e=>{e.exports=h},785:e=>{e.exports=b},533:e=>{e.exports=v},186:e=>{e.exports=u},650:e=>{e.exports=i},729:e=>{e.exports=p},553:e=>{e.exports=a}},C={};function O(e){var t=C[e];if(void 0!==t)return t.exports;var n=C[e]={exports:{}};return x[e](n,n.exports,O),n.exports}O.m=x,O.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return O.d(t,{a:t}),t},O.d=(e,t)=>{for(var n in t)O.o(t,n)&&!O.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},O.f={},O.e=e=>Promise.all(Object.keys(O.f).reduce((t,n)=>(O.f[n](e,t),t),[])),O.u=e=>"chunk."+({403:"adaptive-card-extension-supported-icon-map",816:"ms/sp-filepicker-host",821:"webpack-shared-editmode-fabric-dialog"}[e]||e)+"_"+({816:1}[e]?"en-us":"none")+"_"+{128:"7ea9362fcbdd9872656b",403:"833f60affd1b56c02054",816:"342fd476908bbc253475",821:"f12e504a0e978ec54853"}[e]+".js",O.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),S={},D="c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0:",O.l=(e,t,n,a)=>{if(S[e])S[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==D+n){i=c;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,O.nc&&i.setAttribute("nonce",O.nc),i.setAttribute("data-webpack",D+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),S[e]=[t];var d=(t,n)=>{i.onerror=i.onload=null,clearTimeout(l);var a=S[e];if(delete S[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),r&&document.head.appendChild(i)}},O.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},I=e?e.src:"",O.p=I.slice(0,I.lastIndexOf("/")+1),O.f.compat=(e,t)=>{for(var n=function(e){var t={i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.14",m:853};return{128:[t],816:[t,{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.4.109",m:362}]}[e]||[]}(e),a=0;a<n.length;a++)O.m[n[a].m]||(e=>{t.push(w.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{O.m[e.m]=e=>e.exports=t}))})(n[a])};var w=O(37);(()=>{var e={755:0};O.f.j=(t,n)=>{var a=O.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=O.p+O.u(t),o=new Error;O.l(r,n=>{if(O.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)O.o(o,a)&&(O.m[a]=o[a]);s&&s(O)}for(t&&t(n);c<r.length;c++)i=r[c],O.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var E={};return(()=>{O.r(E),O.d(E,{DeferredDialog:()=>T,DeferredDialogContent:()=>R,DeferredDialogFooter:()=>F,DocLibraryContext:()=>M,FilePickerLoader:()=>n,LazyDialog:()=>P,LazyDialogContent:()=>H,LazyDialogFooter:()=>U,LinkTextBox:()=>se,LocalFilePreview:()=>k,PropertyPaneAudienceToggle:()=>re,SPFileHandler:()=>x,SPFileHandlerError:()=>h,SPFilePickerHostLoader:()=>o,ThumbnailSourceType:()=>z,ThumbnailType:()=>V.ThumbnailType,calculateExifOrientation:()=>l,convertDataUriToArrayBuffer:()=>u,ensureOrientation:()=>d,getIconUrl:()=>$,getPropertyPaneThumbnail:()=>X,rotatedExifOrientation:()=>c,supportedIcons:()=>Z});var e=O(377),t=O(37);const n=function(){function n(){}return n.load=function(n,a){return t.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(function(t){var i=new t.FilePicker(n);return i.initialize(a),i.fetchData().catch(function(t){return e._TraceLogger.logError(e._LogSource.create("FilePickerLoader"),t,"fetchData")}),i})},n}();var a=O(553),i=O(650),r=i.lazy(function(){return Promise.all([O.e(128),O.e(816)]).then(O.bind(O,101)).then(function(e){return{default:e.SPFilePickerHost}})});function o(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(r,(0,a.__assign)({},e)))}var s=O(878),c=[5,6,7,8];function d(t,n){if(t&&t.src){var a=s._BrowserDetection.getBrowserInformation();a.browser===s._Browser.Firefox||(a.browser===s._Browser.Chrome||a.browser===s._Browser.EdgeChromium)&&a.browserVersion&&a.browserVersion.greaterThan(s.Version.parse("81.0.0.0"))?t.style.visibility="visible":u(t.src).then(function(e){return l(e)}).then(function(e){if(void 0===e||isNaN(e)||1===e)return t.style.transform=void 0,void(t.style.visibility="visible");var a;switch(-1!==[5,6,7,8].indexOf(e)&&n&&n(),e){case 2:a="-1, 0, 0, 1, 0, 0";break;case 3:a="-1, 0, 0, -1, 0, 0";break;case 4:a="1, 0, 0, -1, 0, 0";break;case 5:a="0, 1, 1, 0, 0, 0";break;case 6:a="0, 1, -1, 0, 0, 0";break;case 7:a="0, -1, -1, 0, 0, 0";break;case 8:a="0, -1, 1, 0, 0, 0"}t.style.transform="matrix(".concat(a,")"),t.style.visibility="visible"}).catch(function(t){return e._TraceLogger.logError(e._LogSource.create("ensureOrientation"),t,"convertDataUriToArrayBuffer")})}}function l(e){if(!e)return Promise.resolve(void 0);var t=new DataView(e);if(65496!==t.getUint16(0,!1))return Promise.resolve(void 0);for(var n=t.byteLength,a=2;a<n;){var i=t.getUint16(a,!1);if(a+=2,65505===i){if(1165519206!==t.getUint32(a+=2,!1))return Promise.resolve(void 0);var r=18761===t.getUint16(a+=6,!1);a+=t.getUint32(a+4,r);var o=t.getUint16(a,r);a+=2;for(var s=0;s<o;s++)if(274===t.getUint16(a+12*s,r)){var c=t.getUint16(a+12*s+8,r);return Promise.resolve(c)}}else{if(65280!=(65280&i))break;a+=t.getUint16(a,!1)}}return Promise.resolve(void 0)}function u(e){return fetch(e).then(function(e){return e.arrayBuffer()}).catch(function(e){})}var f=O(962),p=O(272),m=O(171),_=O(616),h=function(e){function t(n,a){var i=e.call(this,n)||this;return i.__proto__=t.prototype,i.errorCode=a,i}return(0,a.__extends)(t,e),t}(Error);const b=JSON.parse('{"D0":"The security validation for this page has timed out. Refresh the page or use the back button in your browser to try again.","SE":"The file or folder {0} contains invalid characters such as # % * : < > ? / | and cannot be selected.","jr":"Access denied. You do not have permission to perform this action or access this resource.","Fo":"Can\\u0027t upload this item. Please refresh the page."}');function g(e,t,n){return"".concat(e,"=%27").concat(_.UriEncoding.encodeRestUriStringToken(t,n),"%27")}function v(e){return{listId:e.ListId,uniqueId:e.UniqueId,serverRelativeUrl:e.ServerRelativeUrl,title:e.Title}}function y(e,t){return!!e.code&&String(e.code).indexOf(t)>-1}function S(){return s._SPKillSwitch.isActivated("42f427de-65a5-49c9-9e71-1c1c6a677c11")}function D(){return s._SPKillSwitch.isActivated("e8f99b98-01b3-40b3-93ba-3e3cf9070b88")}function I(){return s._SPKillSwitch.isActivated("3f9bf326-f86b-4992-b5fe-87eae7ab8390")}var x=function(){function t(e){var n=this;e.serviceScope.whenFinished(function(){n._httpClient=e.serviceScope.consume(p.SPHttpClient.serviceKey),n._pageContext=e.serviceScope.consume(m.PageContext.serviceKey),n._pageService=e.serviceScope.consume((0,f.getPageServiceServiceKey)())}),this._qosPrefix=e.qosPrefix,this._containerUrl=e.containerUrl,t._isDisableSitePagesStrongBinding=e.isDisableSitePagesStrongBinding}return Object.defineProperty(t,"pagePathName",{get:function(){return-1!==window.location.pathname.toUpperCase().indexOf("/NEWPAGE.ASPX")&&e._TraceLogger.logError(t._logSource,new Error("Page media upload before page titled.")),window.location.pathname},enumerable:!1,configurable:!0}),t.replaceSpecialCharacters=function(e){return function(e){var t=new RegExp("[&/\\# ,+()$~'\":*?<>{}|]|%2.","g");return e?e.replace(t,"-"):""}(e)},t.validateFileType=function(e,t){var n,a=(null==e?void 0:e.name)||e,i=a.lastIndexOf(".");return-1!==i&&(n=a.substring(i+1,a.length),t.indexOf(n.toLowerCase())>-1)},t._isPageAssetFolderBindingEnabled=function(){return!s._SPKillSwitch.isActivated("5b8b049b-2476-4c92-8599-2e0a94837a43")&&s._SPFlight.isEnabled(60296)&&!this._isDisableSitePagesStrongBinding},t.prototype.readFile=function(n){var a=this;return this._reader||(this._reader=new FileReader),new Promise(function(i,r){n||(e._TraceLogger.logVerbose(t._logSource,"File is undefined"),r(new RangeError("FileUndefined"))),a._reader.onloadend=function(){return i(a._reader.result)},a._reader.onerror=function(){e._TraceLogger.logVerbose(t._logSource,"Error occurred when reading the file"),r(a._reader.error)},a._reader.readAsDataURL(n)})},t.prototype.uploadLocalFile=function(e,n,a,i,r){var o=this;return void 0===i&&(i=!1),t._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(function(t){return t.executeActionAsync(function(){return o._uploadLocalFile(e,n,a,i,r)})}):this._uploadLocalFile(e,n,a,i,r)},t.prototype.uploadExternalFile=function(e,n,a){var i=this;return t._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(function(t){return t.executeActionAsync(function(){return i._uploadExternalFile(e,n,a)})}):this._uploadExternalFile(e,n)},t.prototype.validateMimeType=function(e,t){if(e.type){var n=e.type.slice(e.type.lastIndexOf("/")+1);if(n)return t.indexOf(n.toLowerCase())>-1}return!1},t.prototype.getPageName=function(n){void 0===n&&(n=""),n=n.trim();var a=this.removeExtension(n),i=t.replaceSpecialCharacters(a),r=new e._QosMonitor("FilePicker.UploadItem.GetPageName");if(i)r.writeSuccess();else{var o=this._pageContext.listItem&&this._pageContext.listItem.id||"fastPageCreation";r.writeUnexpectedFailure("EmptyPageName",void 0,{pathNameTrimmedLen:n.length,isPathNameEndWithSlash:("/"===n[n.length-1]).toString(),isPageTitleEmpty:(!a.trim()).toString(),pageId:o.toString()}),i=o.toString()}return i},t.prototype.removeExtension=function(e){var t=e.lastIndexOf("/"),n=-1===t?e:e.substring(t+1),a=n.lastIndexOf(".");return-1===a?n:n.substring(0,a)},t.prototype._uploadCore=function(e,t){var n=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"",a=new Headers;a.append("accept","application/json; odata=nometadata"),a.append("OData-version","3.0");var i=_.Uri.concatenate(n,e);return this._httpClient.post(i,p.SPHttpClient.configurations.v1,{headers:a,body:t})},t.prototype._uploadLocalFile=function(n,a,i,r,o){var c;void 0===r&&(r=!1);var d,l=n instanceof File?n.name:void 0,u=a||l,f=!s._SPKillSwitch.isActivated("24ae812f-4669-4754-920f-322c88338efb")&&n instanceof File?n.size:void 0,p=new e._QosMonitor("".concat(this._qosPrefix,".UploadLocalFile"));t._isPageAssetFolderBindingEnabled()&&!r&&(d=o||(null===(c=this._pageContext.listItem)||void 0===c?void 0:c.id));var m,_=this._getEndPoint(u,d,void 0,i,f);return this._uploadCore(_,n).then(function(e){return m=e.correlationId,e.json()}).then(function(e){var t=e["odata.error"];if(!t)return p.writeSuccess(),v(e);!function(e,t,n,a){var i={odataErrorCode:e.code,odataErrorMessage:e.message&&e.message.value,correlationId:n?n.toString():void 0};throw y(e,"-2130575252")?(t.writeExpectedFailure("SecurityValidationTimeOut",void 0,i),new h(b.D0,e.code)):y(e,"-2130575245")?(t.writeExpectedFailure("InvalidCharacters",void 0,i),new h(s.Text.format(b.SE,a),e.code)):y(e,"-2147024891")?(t.writeExpectedFailure("NoPermission",void 0,i),new h(b.jr,e.code)):y(e,"-2130575257")||y(e,"-2130575342")?(t.writeExpectedFailure("FileFolderAlreadyExists",void 0,i),new h(b.jr,e.code)):(t.writeUnexpectedFailure("UncategorizedError",void 0,i),new h(b.Fo,e.code))}(t,p,m,u)}).catch(function(e){throw p.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new h(b.Fo)})},t.prototype._uploadExternalFile=function(n,a,i){var r,o,s=this._getEndPoint(a,t._isPageAssetFolderBindingEnabled()?null===(r=this._pageContext.listItem)||void 0===r?void 0:r.id:void 0,n,void 0,void 0,i),c=new e._QosMonitor("".concat(this._qosPrefix,".UploadExternalFile"));return this._uploadCore(s,void 0).then(function(e){return o=e.correlationId,e.json()}).then(function(e){var t=e["odata.error"];if(t){var n={odataErrorCode:t.code,odataErrorMessage:t.message&&t.message.value,correlationId:o?o.toString():void 0};throw c.writeUnexpectedFailure("UncategorizedError",void 0,n),new h(b.Fo,t.code)}return c.writeSuccess(),v(e)}).catch(function(e){throw c.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new h(b.Fo)})},t.prototype._getEndPoint=function(e,n,a,i,r,o){e=encodeURIComponent(e);var c="$select=ListId,ServerRelativeUrl,Title,UniqueId",d=t._isPageAssetFolderBindingEnabled()&&void 0!==n?"&".concat("pageId","=").concat(n):"",l=r?"&".concat("fileSize","=").concat(r):"";if(this._containerUrl){var u=encodeURIComponent(this._containerUrl);return"/_api/web/GetFolderByServerRelativeUrl("+s.UrlUtilities.convertToODataStringLiteral(u)+")/Files/Add(url="+s.UrlUtilities.convertToODataStringLiteral(e)+", overwrite=false)?".concat(c)}return a?"/_api/sitepages/AddImageFromExternalUrl?"+this._createSitePageEndpoint(e,i,o)+"&"+g("externalUrl",a,o)+"".concat(d,"&").concat(c):"/_api/sitepages/AddImage?"+this._createSitePageEndpoint(e,i)+"".concat(d).concat(l,"&").concat(c)},t.prototype._createSitePageEndpoint=function(e,n,a){var i=n||this.getPageName(t.pagePathName);return g("imageFileName",e)+"&"+g("pageName",i,a)},t._logSource=e._LogSource.create("PublishingWebPartSPFileHandler"),t}(),C=O(79),w=O(186),A=O(230);A.loadStyles('.a_a_7c0c6d12{background-position:50%;background-repeat:no-repeat;background-size:cover;height:100%;margin:0 auto;width:100%;z-index:0}.a_a_7c0c6d12:before{background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.a_a_7c0c6d12 .b_a_7c0c6d12{color:#fff;padding:10px;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .a_a_7c0c6d12 .b_a_7c0c6d12{left:50%}[dir=rtl] .a_a_7c0c6d12 .b_a_7c0c6d12{right:50%}.a_a_7c0c6d12 .b_a_7c0c6d12 .c_a_7c0c6d12{animation:e_a_7c0c6d12 2s linear infinite;display:block;font-size:48px;margin:8px 0}@keyframes e_a_7c0c6d12{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.a_a_7c0c6d12 .f_a_7c0c6d12{max-height:100%;max-width:100%;opacity:.5;position:relative;visibility:hidden}.a_a_7c0c6d12 .g_a_7c0c6d12{color:"[theme:white, default: #ffffff]";font-size:21px;font-weight:100;font-weight:300}.a_a_7c0c6d12 img{display:block;margin:0 auto;max-width:100%}.a_a_7c0c6d12 img:not([src]){display:none}',!0);const L=JSON.parse('{"k4":"We\\u0027re still uploading your image. It may get lost if you leave this page.","vF":"Preview image that shows while an image is uploading.","Xf":"This doesn\\u0027t seem like a supported image file. Please select a different image."}'),k=function(t){function n(e){var n=t.call(this,e)||this;return n._isImageFlipped=!1,n._handleImageLoad=function(e){d(e.target,function(){n._isImageFlipped=!0})},n._startUpload=function(e){var t=new w._QosMonitor(n.props.QosTag);try{var a="",i=n._getPrefix(),r="src"in e;if(e instanceof File&&x.validateFileType(e,f.spConstants.imageExtensions))a="".concat(i,"-").concat(x.replaceSpecialCharacters(e.name));else if(e instanceof Blob&&n._spFileHandler.validateMimeType(e,f.spConstants.imageExtensions))a="".concat(i,".").concat(e.type.split("/").pop());else{if(!r||!x.validateFileType(e.src,f.spConstants.imageExtensions))return n._onUploadError(new Error(L.Xf)),void t.writeExpectedFailure("InvalidFileType");e=e,a="".concat(i,"-").concat(x.replaceSpecialCharacters(e.name))}window.addEventListener("beforeunload",n._promptUploadingWarning),(e instanceof File||e instanceof Blob?n._spFileHandler.uploadLocalFile(e,a):n._spFileHandler.uploadExternalFile(e.src,a)).then(function(a){n._onUploadComplete(a,e instanceof File?e.name:void 0),t.writeSuccess()}).catch(function(e){t.writeUnexpectedFailure("UploadPromise",e),n._onUploadError(e)})}catch(e){t.writeUnexpectedFailure("CatchAll",e),n._onUploadError(e)}},n._startUploadFromExternalUrl=function(e){var t=new w._QosMonitor(n.props.QosTag);try{var a=e.lastIndexOf("/"),i=e.substring(a+1),r=n._getPrefix()+x.replaceSpecialCharacters(i);window.addEventListener("beforeunload",n._promptUploadingWarning),n._spFileHandler.uploadExternalFile(e,r).then(function(e){n._onUploadComplete(e,r),t.writeSuccess()}).catch(function(e){!s._SPKillSwitch.isActivated("4bbb0260-aa53-40c5-be12-85757fc05bc9")&&n.props.localFile?n._startUpload(n.props.localFile):(t.writeUnexpectedFailure("UploadPromise",e),n._onUploadError(e))})}catch(e){t.writeUnexpectedFailure("CatchAll",e),n._onUploadError(e)}},n._onUploadComplete=function(e,t){if(window.removeEventListener("beforeunload",n._promptUploadingWarning),n._imagePreview&&n._imagePreview.naturalHeight&&n._imagePreview.naturalWidth){var a=n._isImageFlipped?n._imagePreview.naturalHeight:n._imagePreview.naturalWidth,i=n._isImageFlipped?n._imagePreview.naturalWidth:n._imagePreview.naturalHeight;n.props.onUploadComplete(e,t,a,i)}else n.props.onUploadComplete(e,t)},n._onUploadError=function(e){window.removeEventListener("beforeunload",n._promptUploadingWarning),n.props.onUploadError&&n.props.onUploadError(e,n.props.externalFile?n.props.externalFile.src:void 0)},n._getPrefix=function(){return Math.floor(4294967296*Math.random()).toString()},n._spFileHandler=new x({serviceScope:e.serviceScope,qosPrefix:e.QosTag}),n.state={imageDataString:void 0},n}return(0,a.__extends)(n,t),n.prototype.UNSAFE_componentWillMount=function(){var e=this.props,t=e.externalFile,n=e.imageUrl,a=e.localFile,i=e.pageContext;t?this._startUpload(t):n&&f.UrlUtility.isValidURL(n)&&!f.UrlUtility.isVanityUrl(n,i)?this._startUploadFromExternalUrl(n):a&&this._startUpload(a)},n.prototype.componentDidMount=function(){this._setStateForLocalFile()},n.prototype.componentWillUnmount=function(){this._rejectPromise&&(this._rejectPromise(),this._rejectPromise=void 0)},n.prototype.render=function(){var e=i.createElement("img",{className:"f_a_7c0c6d12",alt:L.vF,src:this.state.imageDataString,ref:this._resolveRef("_imagePreview"),onLoad:this._handleImageLoad});return i.createElement("div",{className:"a_a_7c0c6d12",ref:this._resolveRef("_root"),"data-automation-id":"localFilePreview"},this.state.imageDataString&&e,i.createElement("div",{className:"b_a_7c0c6d12"},i.createElement(C.Icon,{iconName:"Sync",className:"c_a_7c0c6d12"}),i.createElement("span",{className:"g_a_7c0c6d12","aria-live":"assertive","aria-atomic":!0},this.props.uploadingMessage)))},n.prototype._setStateForLocalFile=function(){var t=this;this.props.localFile?new Promise(function(e,n){t._rejectPromise=n,e(t._spFileHandler.readFile(t.props.localFile))}).then(function(e){t.setState({imageDataString:e})}).catch(function(t){e._TraceLogger.logError(e._LogSource.create("LocalFilePreview"),t,"ReadLocalFile")}):this.props.externalFile&&this.setState({imageDataString:this.props.externalFile.src})},n.prototype._promptUploadingWarning=function(e){var t=L.k4;return e.returnValue=t,t},n}(C.BaseComponent),M=function(){function e(e,t,n){var a,i,r,o=this;e.whenFinished(function(){o._spHttpClient=e.consume(p.SPHttpClient.serviceKey),r=e.consume(m.PageContext.serviceKey)}),!s._SPKillSwitch.isActivated("2097ba85-7386-407a-b0e8-a92e4f1f4053")&&n?(this._webAbsoluteUrl=n.webAbsoluteUrl||"",this._webId=n.webId,this._siteId=n.siteId):((null==r?void 0:r.web)?(this._webAbsoluteUrl=r.web.absoluteUrl,this._webId=r.web.id&&r.web.id.toString()||""):this._webAbsoluteUrl=this._webId="",this._siteId=(null===(i=null===(a=null==r?void 0:r.site)||void 0===a?void 0:a.id)||void 0===i?void 0:i.toString())||""),this._errorCallback=t}return Object.defineProperty(e.prototype,"defaultDocumentLibrary",{get:function(){var e=_.Uri.concatenate(this._webAbsoluteUrl,"_api/web/DefaultDocumentLibrary?$expand=RootFolder");return this._spHttpClient.get(e,p.SPHttpClient.configurations.v1).then(function(e){return e.json()})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteContext",{get:function(){var e=this;return this._siteContext?Promise.resolve(this._siteContext):this._getContainingFolderSiteContext().then(function(t){return e._siteContext=t,t})},enumerable:!1,configurable:!0}),e.prototype._getContainingFolderSiteContext=function(){var e=this,t={webAbsoluteUrl:this._webAbsoluteUrl,libraryName:"",defaultLibraryId:"",pickerDomain:window.location.protocol+"//"+window.location.hostname,siteId:this._siteId,webId:this._webId},n=new w._QosMonitor("GetWebDefaultLibrary");return this.defaultDocumentLibrary.then(function(e){if(e.error)throw new Error(e.error.code);return t.libraryName=e.RootFolder.Name,t.defaultLibraryId=e.Id,n.writeSuccess(),t}).catch(function(a){if(a.message.indexOf("-2146232832")>=0?n.writeExpectedFailure("ListDeleted"):n.writeUnexpectedFailure(void 0,a),e._errorCallback)return e._errorCallback(t),t;throw a})},e}();var P=i.lazy(function(){return Promise.all([O.e(128),O.e(821)]).then(O.bind(O,80)).then(function(e){return{default:e.Dialog}})});function T(e){var t=e.fallback,n=void 0===t?i.createElement(i.Fragment,null):t,r=(0,a.__rest)(e,["fallback"]);return i.createElement(i.Suspense,{fallback:n},i.createElement(P,(0,a.__assign)({},r)))}var U=i.lazy(function(){return Promise.all([O.e(128),O.e(821)]).then(O.bind(O,80)).then(function(e){return{default:e.DialogFooter}})});function F(e){var t=e.fallback,n=void 0===t?i.createElement(i.Fragment,null):t,r=(0,a.__rest)(e,["fallback"]);return i.createElement(i.Suspense,{fallback:n},i.createElement(U,(0,a.__assign)({},r)))}var H=i.lazy(function(){return Promise.all([O.e(128),O.e(821)]).then(O.bind(O,80)).then(function(e){return{default:e.DialogContent}})});function R(e){var t=e.fallback,n=void 0===t?i.createElement(i.Fragment,null):t,r=(0,a.__rest)(e,["fallback"]);return i.createElement(i.Suspense,{fallback:n},i.createElement(H,(0,a.__assign)({},r)))}var N=O(541),B=O(729),j=O(134),V=O(723),z={Image:1,FabricReactIcon:2,AutoSelect:3};const G=JSON.parse('{"aW":"Alternate text field for thumbnail image","q2":"Thumbnail","fS":"Auto-selected","Vj":"Custom image","et":"Library","U4":"Uploading...","EY":"0||1||2-","T7":"{0} characters||{0} character||{0} characters","Bv":"{0} limit - exceeded by {1}","Le":"{0} limit - {1} left","W5":"{0} character"}');var K=function(e){function t(n){var a=e.call(this,n)||this;return a._onValidChange=function(e){var t,n,i,r;a._handleGetErrorMessage(e||"")||(s._SPKillSwitch.isActivated("3ffa6b5d-b309-4f16-a93d-86d9e47d73cb")?null===(r=(i=a.props).onChange)||void 0===r||r.call(i,e):null===(n=(t=a.props).onChange)||void 0===n||n.call(t,a.props.label,e),a.props.onValidChange&&a.props.onValidChange(e||""))},a._handleGetErrorMessage=function(e){if(!e||e.length<=a.props.maxCharacters)return"";var n=t._getLocalizedCount(a.props.maxCharacters),i=t._getLocalizedCount(e.length-a.props.maxCharacters);return _.StringHelper.format(G.Bv,n,i)},a._getLimitedLengthMessage=function(e){return e>=0?_.StringHelper.format(G.Le,_.StringHelper.format(G.W5,a.props.maxCharacters),t._getLocalizedCount(e)):""},a.state={value:n.initialValue||""},a}return(0,a.__extends)(t,e),t.getTextFieldGroup=function(e,n){return(0,j.PropertyPaneCustomField)({key:e,onRender:function(r,o,s){var c=i.createElement(t,(0,a.__assign)({key:e,onChange:s},n));N.render(c,r)},onDispose:function(e){B.unmountComponentAtNode(e)}})},t._getLocalizedCount=function(e){return _.StringHelper.formatWithLocalizedCountValue(G.T7,G.EY,e)},t.prototype.render=function(){return i.createElement(f.LimitedLengthTextField,{label:this.props.label,multiline:this.props.multiline,value:this.state.value,defaultValue:this.state.value,onChanged:this._onValidChange,maxLength:this.props.maxCharacters,getLimitedLengthMessage:this._getLimitedLengthMessage})},t}(i.PureComponent),W=O(785),q=function(t){function n(e){var n=t.call(this,e)||this;return n.state={isRenderBackup:!1},n}return(0,a.__extends)(n,t),n.prototype.render=function(){var e,t,n,a,r=this._content,o=void 0;return!s._SPKillSwitch.isActivated("d3e7d14b-3886-4b5c-9b1b-d1ba5675074d")&&(null===(e=this.props.thumbnail)||void 0===e?void 0:e.type)===V.ThumbnailType.FabricReactIcon&&(null===(t=this.props.thumbnail)||void 0===t?void 0:t.iconColor)&&(o=null===(n=this.props.thumbnail)||void 0===n?void 0:n.iconColor),!!r&&i.createElement("div",{role:"img",className:this.props.className,"aria-label":null===(a=this.props.thumbnail)||void 0===a?void 0:a.altText,style:o?{fill:o}:void 0},r)},Object.defineProperty(n.prototype,"_content",{get:function(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();var t=this.props.thumbnail;if(t)switch(t.type){case V.ThumbnailType.FabricReactIcon:return i.createElement(C.Icon,{iconName:t.iconName,style:t.iconColor?{color:t.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case V.ThumbnailType.IconSizeImage:var n={className:this.props.iconClassName,imageFit:C.ImageFit.cover,src:t.iconUrl,role:"presentation",alt:t.altText};return i.createElement(C.Icon,{iconType:C.IconType.image,style:t.iconColor?{color:t.iconColor}:void 0,imageProps:n,className:this.props.iconClassName});case V.ThumbnailType.Image:var a={imageFit:void 0!==t.imageFit?t.imageFit:C.ImageFit.cover,src:this.state.isRenderBackup&&t.backupImageUrl?t.backupImageUrl:t.imageUrl,alt:t.altText,title:t.altText?t.altText:void 0,role:t.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange,styles:{image:{width:"100%",height:"100%"}}};return S()||(this._imageMonitor=new e._QosMonitor("".concat(this.props.qosPrefix,".ImageLoad"))),i.createElement(C.Icon,{iconType:C.IconType.image,imageProps:a,className:this.props.iconClassName});default:return}},enumerable:!1,configurable:!0}),n.prototype._handleImageLoadingStateChange=function(e){!S()&&this._imageMonitor&&(e===C.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===C.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(function(t){if(e===C.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})},(0,a.__decorate)([C.autobind],n.prototype,"_handleImageLoadingStateChange",null),n}(i.PureComponent);A.loadStyles('.i_c_7c0c6d12{position:relative}.i_c_7c0c6d12.j_c_7c0c6d12{background-color:"[theme:neutralLight, default: #edebe9]"}.k_c_7c0c6d12{padding-bottom:56.25%;width:100%}.l_c_7c0c6d12{height:100px;width:100px}.m_c_7c0c6d12{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.m_c_7c0c6d12.n_c_7c0c6d12{font-size:64px;line-height:100%;text-align:center}.m_c_7c0c6d12.o_c_7c0c6d12 .p_c_7c0c6d12{height:100%;width:100%}.m_c_7c0c6d12.q_c_7c0c6d12 .p_c_7c0c6d12{height:64px;width:64px}.r_c_7c0c6d12{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,r,o=(0,C.css)(this.props.wrapperClassName,"i_c_7c0c6d12",this.props.previewFullWidth?"k_c_7c0c6d12":"l_c_7c0c6d12",((e={}).j_c_7c0c6d12=this.props.previewGrayBackground,e)),s=(0,C.css)("m_c_7c0c6d12",((t={}).n_c_7c0c6d12=(null===(n=this.props.thumbnail)||void 0===n?void 0:n.type)===V.ThumbnailType.FabricReactIcon,t.q_c_7c0c6d12=(null===(a=this.props.thumbnail)||void 0===a?void 0:a.type)===V.ThumbnailType.IconSizeImage,t.o_c_7c0c6d12=(null===(r=this.props.thumbnail)||void 0===r?void 0:r.type)===V.ThumbnailType.Image,t));return this.props.showLoading?i.createElement("div",{className:o},i.createElement(W.Spinner,{className:"r_c_7c0c6d12",type:C.SpinnerType.large,label:G.U4})):i.createElement("div",{className:o},i.createElement(q,{thumbnail:this.props.thumbnail,className:s,iconClassName:(0,C.css)(this.props.iconClassName,"p_c_7c0c6d12"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))},t}(i.PureComponent),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldShowThumbnailRenderer=function(){return D()?Boolean(t.props.thumbnail&&(t.props.thumbnail.iconName||t.props.thumbnail.imageUrl||t.props.thumbnail.backupImageUrl)):Boolean(t.props.thumbnail&&(t.props.thumbnail.iconName||t.props.thumbnail.imageUrl||t.props.thumbnail.backupImageUrl))||t._isCustomIconPresent},t._renderCustomIcon=function(){return t.props.customIconSet.get(t.props.customSelectedIconName)},t}return(0,a.__extends)(t,e),t.prototype.render=function(){return s._SPKillSwitch.isActivated("31582809-6161-4521-87df-a8eb72575445")||!this.props.thumbnail||this.props.thumbnail.altText||(this.props.thumbnail.altText=this.props.customSelectedIconName?this.props.customSelectedIconName.split("_").join(" "):"Custom Selected Thumbnail"),this._shouldShowThumbnailRenderer()?i.createElement(Q,{thumbnail:this.props.thumbnail,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.qosPrefix,onRenderThumbnail:this._isCustomIconPresent?this._renderCustomIcon:void 0}):null},Object.defineProperty(t.prototype,"_isCustomIconPresent",{get:function(){return Boolean(this.props.customIconSet&&this.props.customSelectedIconName)},enumerable:!1,configurable:!0}),t}(i.PureComponent);function J(e,t,n){return K.getTextFieldGroup(n,{label:G.aW,initialValue:t,multiline:!1,maxCharacters:255,onValidChange:e})}function X(e,t,n,a,r,o,s,c){var d=[],l=[];switch(r.autoSelectOptions.enabled&&l.push({key:z.AutoSelect,disabled:r.disabled&&!I(),text:r.autoSelectOptions.optionLabel||G.fS,checked:a===z.AutoSelect}),r.imageOptions.enabled&&l.push({key:z.Image,disabled:r.disabled&&!I(),text:r.imageOptions.optionLabel||G.Vj,checked:a===z.Image}),r.iconOptions.enabled&&l.push({key:z.FabricReactIcon,disabled:r.disabled&&!I(),text:r.iconOptions.optionLabel||G.et,checked:a===z.FabricReactIcon}),d.push((0,j.PropertyPaneChoiceGroup)(t,{options:l,label:(null==s?void 0:s.pickerLabelOverride)||G.q2})),a){case z.Image:d.push(function(e,t,n,a,i,r,o){return(0,V.PropertyPaneThumbnailPicker)("imagePicker",{serviceScope:t,onItemChanged:a,thumbnail:n.thumbnailInfo,callerName:e,previewFullWidth:null==i?void 0:i.previewFullWidth,previewGrayBackground:null==i?void 0:i.previewGrayBackground,thumbnailRendererWrapperClassName:null==i?void 0:i.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:null==i?void 0:i.thumbnailRendererIconClassName,onItemDeleted:n.itemDeleteCallback,forceFullUrl:r,disabled:o})}(e,n,r.imageOptions,r.imageChangeCallback,s,r.ensureImageFullUrl,r.disabled)),o&&d.push(J(o.altTextChangeCallback,o.currentAltText,o.altTextFieldKey));break;case z.AutoSelect:d.push(function(e,t,n,a,r){var o={thumbnail:e,previewFullWidth:null==t?void 0:t.previewFullWidth,previewGrayBackground:null==t?void 0:t.previewGrayBackground,thumbnailRendererWrapperClassName:null==t?void 0:t.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:null==t?void 0:t.thumbnailRendererIconClassName,qosPrefix:n,customIconSet:a,customSelectedIconName:r},s=i.createElement(Y,o);return(0,j.PropertyPaneCustomField)({key:"imagePicker",onRender:function(e){N.render(s,e)}})}(r.autoSelectOptions.thumbnailInfo,s,e,r.customIconSet,r.customSelectedIconName)),o&&d.push(J(o.altTextChangeCallback,o.currentAltText,o.altTextFieldKey));break;case z.FabricReactIcon:d.push(function(e,t,n,a,i,r,o,s){return(0,V.PropertyPaneIconPicker)("iconPicker",{thumbnail:t.thumbnailInfo,onItemChanged:e,previewFullWidth:null==n?void 0:n.previewFullWidth,previewGrayBackground:null==n?void 0:n.previewGrayBackground,thumbnailRendererWrapperClassName:null==n?void 0:n.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:null==n?void 0:n.thumbnailRendererIconClassName,callerName:a,customIconSet:i,customSelectedIconName:r,onItemDeleted:t.itemDeleteCallback,_extendedIcons:o,disabled:s})}(r.iconChangeCallback,r.iconOptions,s,e,r.customIconSet,r.customSelectedIconName,r.extendedIcons,r.disabled))}return d}var Z=["airplane_take_off","alert","alert_urgent","approvals_app","apps","apps_add_in","archive","attach","backpack","balloon","beach","bed","block","board","bookmark","bug","building","building_bank","building_shop","building_skyscraper","calendar_checkmark","calendar_clock","calendar_edit","calendar_question_mark","calendar_reply","calendar_sync","calendar_work_week","call","camera","cart","channel","channel_add","channel_alert","channel_share","chat","city","clipboard","clipboard_paste","clock","cloud_download","comment_mention","comment_multiple","communication","compass_northwest","compose","conference_room","contact_card_group","copy","cube","currency_dollar_euro","dentist","desktop","desktop_mac","doctor","document","document_add","document_catch_up","document_question_mark","drafts","drink_beer","drink_coffee","dumbbell","emoji","emoji_add","error_circle","filter","flag","flag_off","flash","flash_checkmark","glasses","globe","grid","guest","hat_graduation","headset","heart","highlight","home","home_checkmark","image","image_edit","important","info","inking_tool","inprivate_account","key","laptop","leaf_two","library","lightbulb","link","location","location_off","lock_closed","mail","mail_inbox","map_drive","math_formula","meet_now","megaphone","mic_off","mic_on","mic_prohibited","money","movies_and_tv","music_note_2","my_location","options","page_fit","paint_brush","paint_bucket","payment","people","people_add","people_call","people_community","people_search","people_team","person","person_add","person_available","person_call","person_clock","person_mail","person_prohibited","person_question_mark","person_support","premium","reading_list","record","remote","reward","ribbon","rocket","ruler","run","savings","search","send","settings","shield","shifts","slide_text","snooze","speaker_0","speaker_1","sport","star","stop","store_microsoft","sync_off","table","table_simple","tab","tag","target","tasks","tent","tetris_app","thumb_like","timer","trophy","tv","vault","vehicle_bicycle","vehicle_bus","vehicle_cab","vehicle_car","vehicle_subway","video","video_person","voicemail","warning","weather_moon","weather_moon_off"];function $(e){return O.e(403).then(O.bind(O,237)).then(function(t){return t.supportedIconMap.get(e)})}var ee=O(488),te=O(533),ne=O(8),ae=function(){function e(){}return e.isWebPartAudienceTargetingEnabled=function(){return s._SPFlight.isEnabled(60668)},e}();A.loadStyles(".h_b_7c0c6d12{display:inline-flex}",!0);const ie=JSON.parse('{"Tq":"Enable audience targeting","RC":"Enable audience targeting to promote content to specific audiences across the site.","l5":"Enable audience targeting to show or hide content within this webpart. To show or hide the entire web part, go to the audience targeting section.","Ue":"Press enter to learn more.","L9":"{0} {1}","Es":"On","oU":"Off","r6":"Enabled audience targeting.","Pz":"Disabled audience targeting."}');function re(e,t){var n=ae.isWebPartAudienceTargetingEnabled()?ie.l5:ie.RC,a=_.StringHelper.format(ie.L9,n,ie.Ue),r=t.labelText||ie.Tq,o=i.createElement("div",{className:"h_b_7c0c6d12"},i.createElement(ee.Label,{"aria-label":r},r),i.createElement(te.TooltipHost,{content:n},i.createElement(ne.IconButton,{"aria-label":a,iconProps:{iconName:"info"},href:t.infoLink,target:"_blank"}))),c=s._SPKillSwitch.isActivated("f8859d52-a5fb-46d1-94be-0babc89a0c19");return(0,V.PropertyPaneToggle)(e,{key:e,_label:o,onText:ie.Es,offText:ie.oU,ariaLabel:c?void 0:r,onAriaLabel:c?ie.r6:void 0,offAriaLabel:c?ie.Pz:void 0,dataAutomationId:t.dataAutomationId})}const oe=JSON.parse('{"i":"Link"}');var se=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){var a;if(n.props.enforceHttps){var i=null!==(a=n._ensureProtocol(t))&&void 0!==a?a:"https://";n.setState({textValue:i}),n.props.onUrlUpdated(i)}else n.props.disableProtocolCheck?(n.props.onUrlUpdated(t),n.setState({textValue:t})):(n._ensureProtocolDebounced(t),n.setState({textValue:t}))},n._ensureProtocol=function(e){if(e){if(n.props.enforceHttps)return f.UrlUtility.ensureSchema(e,["https"]);var t=new _.Uri(e).getScheme()?e:n.props.prefix?"".concat(e):"https://".concat(e);n.props.onUrlUpdated(t),n.setState({textValue:t})}},n._ensureProtocolDebounced=(new C.Async).debounce(n._ensureProtocol,1e3),n.state={textValue:t.initialUrl},n}return(0,a.__extends)(t,e),t.prototype.render=function(){return i.createElement(C.TextField,{value:this.state.textValue,placeholder:this.props.prefix?"":"https://",onChange:this._onChange,label:this.props.label||oe.i,prefix:this.props.prefix,disabled:this.props.disabled})},t}(i.PureComponent)})(),E})())})();