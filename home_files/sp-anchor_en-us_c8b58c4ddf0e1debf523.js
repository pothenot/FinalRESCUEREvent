define("bdb0f5dd-3bb4-4b93-b12a-71aa9e20bb09_1.3.17",["@microsoft/sp-diagnostics","tslib","@microsoft/sp-core-library","react","@ms/office-ui-fabric-react-bundle","@ms/odsp-utilities-bundle","@microsoft/load-themed-styles"],(e,t,n,a,i,r,o)=>(()=>{"use strict";var s={230:e=>{e.exports=o},878:e=>{e.exports=n},377:t=>{t.exports=e},616:e=>{e.exports=r},79:e=>{e.exports=i},650:e=>{e.exports=a},553:e=>{e.exports=t}},c={};function d(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={exports:{}};return s[e](n,n.exports,d),n.exports}d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{d.r(l),d.d(l,{AnchorZone:()=>C,HiddenAnchorZone:()=>O,anchorServiceManager:()=>s});var e=d(377),t=d(553),n=d(878),a=e._LogSource.create("AnchorService"),i=/[`"'<>#%{}|\\^~\/\[\];?:@=&\s\0]/g,r=function(){function r(){var i=this;this._componentIdToAnchorDataMap=new Map,this._anchorIdToAnchorDataMap=new Map,this.register=function(r,o){n.Validate.isNonemptyString(r,"uniqueId"),n.Validate.isNotNullOrUndefined(o,"anchorList"),i._componentIdToAnchorDataMap.set(r,o.map(function(e){return(0,t.__assign)((0,t.__assign)({},e),{anchorId:void 0})})),e._TraceLogger.logVerbose(a,"Component '".concat(r,"' registered with ").concat(o.length," anchors"))},this.unregister=function(t){var n=i._componentIdToAnchorDataMap.get(t);n?(n.forEach(function(e){e.anchorId&&(e.onDisposeAnchorId&&e.onDisposeAnchorId(e.anchorTargetElement,e.anchorId),i._anchorIdToAnchorDataMap.delete(e.anchorId))}),i._componentIdToAnchorDataMap.delete(t),e._TraceLogger.logVerbose(a,"Successfully unregistered component '".concat(t,"'"))):e._TraceLogger.logError(a,new Error("Trying to unregister a non-exists component '".concat(t,"'")))},this.finishRegistration=function(){e._TraceLogger.logVerbose(a,"finishRegistration invoked");var t=[];i._componentIdToAnchorDataMap.forEach(function(e){return t=t.concat(e)}),t.sort(r._compareAnchorLocation),i._anchorIdToAnchorDataMap.clear();var o=new Map,s={action:"AnchorsUpdated",sortedAnchors:t.map(function(t){var n=r.sanitizeAnchorId(t.suggestedAnchorId);return n||(n="anchor"),n=i._handleCollision(n,o),t.anchorId=n,i._anchorIdToAnchorDataMap.set(n,t),t.onReceiveAnchorId&&t.onReceiveAnchorId(t.anchorTargetElement,n),e._TraceLogger.logVerbose(a,"Anchor ID '".concat(n,"' allocated")),{anchorText:t.suggestedAnchorId,anchoredElementTagName:t.anchorTargetElement.tagName,anchorId:n}})};n._SPEventManager.instance.raiseStickyEvent("anchorEvent",s)}}return r.sanitizeAnchorId=function(e){return e?e.trim().toLowerCase().replace(i,"-").replace(/-{2,}/g,"-").replace(/^-+|-+$/g,"").substring(0,128):""},r._compareAnchorLocation=function(e,t){return e.anchorTargetElement.compareDocumentPosition(t.anchorTargetElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1},r.prototype.getElementByAnchorId=function(e){var t=this._anchorIdToAnchorDataMap.get(e);return t&&t.anchorTargetElement},r.prototype.scrollTo=function(e){var t,n=this._anchorIdToAnchorDataMap.get(e);return!!n&&(n.anchorTargetElement.scrollIntoView(),null===(t=n.onScrollToAnchorId)||void 0===t||t.call(n,n.anchorTargetElement,e),!0)},r.prototype._handleCollision=function(e,t){for(var n=e,a=0;t.has(n);)n=(e=n)+"-"+(a=t.get(e)||0);return t.set(e,a+1),t.set(n,1),n},r}(),o=function(){function e(){var e=this;this._register=function(t,n){e._anchorService.register(t,n),e._pendingRegistrations.delete(t),e._checkFinishRegistration()},this._unregister=function(t){e._anchorService.unregister(t),e._pendingRegistrations.delete(t),e._checkFinishRegistration()},this._refresh=function(t,n){e._anchorService.register(t,n),e._pendingRegistrations.delete(t),e._checkFinishRegistration()},this._pendingFinishRegistration=!1,this._pendingRegistrations=new Set,this._anchorService=new r}return e.prototype.initialize=function(e){var t=this;e.forEach(function(e){t.handleAnchorEvent(e)})},e.prototype.scrollTo=function(e){var t=this;return new Promise(function(n,a){var i=function(){t._anchorService.scrollTo(e)?n():a(new Error("Failed to find anchor to scroll"))};t._pendingFinishRegistration?t._resolveScroll=i:i()})},e.prototype.handleAnchorEvent=function(e){switch(e.action){case"ReserveRegistration":this._reserveRegistration(e.uniqueId);break;case"Register":this._register(e.uniqueId,e.anchorList);break;case"Unregister":this._unregister(e.uniqueId);break;case"Refresh":this._refresh(e.uniqueId,e.anchorList)}},e.prototype._reserveRegistration=function(e){this._pendingRegistrations.add(e)},e.prototype._checkFinishRegistration=function(){this._pendingRegistrations.size||(this._anchorService.finishRegistration(),this._pendingFinishRegistration=!1,this._resolveScroll&&(this._resolveScroll(),this._resolveScroll=void 0))},e}(),s=new(function(){function t(){var e=this;this.componentId="bdb0f5dd-3bb4-4b93-b12a-71aa9e20bb09",this.instanceId="e1163200-0719-4a64-9f9a-bc6592953704",this.isDisposed=!1,this._anchorServiceQueue=new o,this.reserve=function(t){e._anchorServiceQueue.handleAnchorEvent({action:"ReserveRegistration",uniqueId:t})},this.raiseAnchorEvent=function(t){e._anchorServiceQueue.handleAnchorEvent(t)},this._scroll=function(){if(e._anchorIdToScroll){var t=e._anchorServiceQueue.scrollTo(e._anchorIdToScroll);return e._anchorIdToScroll=void 0,t}return Promise.reject("AnchorId is undefined, multiple scroll Task planned")}}return t.prototype.scrollTo=function(t,n){var a=this;if(void 0===n&&(n=5e3),t||!(n<-1)){var i,r;this._anchorIdToScroll=t;var o=-1!==n?new Promise(function(e){setTimeout(function(){e("timeout")},n)}):void 0,s=new Promise(function(e,t){i=function(){return e("execute")},r=function(){return t("cancel")}}),c=new e._QosMonitor("AnchorService");return{execute:i,cancel:r,scrollPromise:Promise.race([o,s]).then(function(e){return a._scroll().then(function(){"timeout"===e?c.writeExpectedFailure("TimeoutTriggerScroll"):c.writeSuccess()},function(t){c.writeUnexpectedFailure("FailedToScroll",t,{message:e})})}).catch(function(e){c.writeExpectedFailure("CancelScroll",e)})}}},t}()),c=d(650),u=d.n(c),f=d(79),p="data-sp-anchor-id",m=d(616);const _=JSON.parse('{"t":"Permalink for {0}"}');function h(){return n._SPKillSwitch.isActivated("d1f9ae0b-d8f8-4b6f-92ef-aced9099b84a")}var b=function(t,a,i,r,o){var s=new m.Uri(window.location.href);s.setFragment(encodeURIComponent(i));var c=s.toString();t.setAttribute("id",i),a.setAttribute("role","link"),n._SPKillSwitch.isActivated("27fd3db1-8d27-4c91-836c-2767b07fd160")?a.setAttribute("aria-label",n.Text.format(_.t,r)):a.setAttribute("title",n.Text.format(_.t,r)),a.setAttribute(p,i),a.setAttribute("href",c),a.setAttribute("target","_self"),h()||o||a.setAttribute("tabIndex","-1"),a.onclick=function(){e._EngagementLogger.logEvent("AnchorZone.ClickAnchor")}},g=function(e){return{focusBorder:{"&:focus:not(:active) i":{border:"1px solid",borderColor:null==e?void 0:e.semanticColors.focusBorder}}}};function v(){return n._SPKillSwitch.isActivated("5d9f7da7-0e1a-4289-871a-29022f21320f")}var y=d(230);y.loadStyles(".a_a_1310c973{display:contents}.b_a_1310c973{opacity:0;outline:none;position:absolute;text-decoration:none}.b_a_1310c973:focus,:focus>.b_a_1310c973,:hover>.b_a_1310c973{opacity:1;transition:.1s linear}[dir=ltr] .b_a_1310c973.c_a_1310c973{margin-left:5px}[dir=rtl] .b_a_1310c973.c_a_1310c973{margin-right:5px}.b_a_1310c973.c_a_1310c973 .e_a_1310c973{font-style:normal;line-height:1;padding:3px}.b_a_1310c973.c_a_1310c973 .e_a_1310c973.f_a_1310c973{vertical-align:middle}.b_a_1310c973.c_a_1310c973.g_a_1310c973:focus:not(:active) .e_a_1310c973{border:1px solid #605e5c}[dir=ltr] .b_a_1310c973:not(.c_a_1310c973) .e_a_1310c973{margin-left:8px}[dir=rtl] .b_a_1310c973:not(.c_a_1310c973) .e_a_1310c973{margin-right:8px}.e_a_1310c973{font-size:16px;font-style:normal;font-weight:400}",!0);const S="b_a_1310c973";function D(){return n._SPKillSwitch.isActivated("21a5c693-298f-4811-bfa7-2bde29fa2a82")}function I(){return n._SPKillSwitch.isActivated("ff318617-20eb-4b97-bd02-09d26024cef4")}function x(){return n._SPKillSwitch.isActivated("58699f21-6e34-4f29-a76f-14cc8830938e")}var C=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.instanceId="4e00f196-1bdc-4f2a-8581-6075c77437c6",t._addAnchorIcon=function(e,n,a){if(!t.props.hideAnchorIcon){var i=t._insertAnchorIcon(e);try{b(e,i,n,a,!0)}catch(e){}}},t._insertAnchorIcon=function(e){var n,i=void 0;if(D()){for(var r=e.childElementCount,o=0;o<r;o++){var s=e.children[o];if(a._isElementAnchorIcon(s)){i=s;break}if("BR"===s.tagName){i=a._anchorIconElement,e.insertBefore(i,s);break}}i||(i=a._anchorIconElement,e.appendChild(i))}else{var c=e.nextElementSibling;if(c&&a._isElementAnchorIcon(c))i=c;else{if(i=a._anchorIconElement,!I()){var d=(0,f.mergeStyleSets)(g(t.props.variantTheme));i.classList.add(d.focusBorder)}var l,u=document.createElement("div");if(null===(n=e.parentElement)||void 0===n||n.insertBefore(u,e),u.appendChild(e),u.appendChild(i),v())l=(e.clientHeight-i.offsetHeight)/2;else{var p=parseInt(getComputedStyle(e).lineHeight,10);l=(p-i.offsetHeight)/2}var m=document.createElement("span");m.className=S,t._insertElementToAnchoredElement(m,e),u.onmouseover=function(){if(x()){var e=(0,f.getRTL)();i.style.left="".concat(e?m.offsetLeft-i.offsetWidth-5:m.offsetLeft,"px"),i.style.top="".concat(m.offsetTop+l,"px")}else t._dynamicallySetAnchorPosition(l,i,m)},x()||(i.onfocus=function(){t._dynamicallySetAnchorPosition(l,i,m)})}}return i},t._insertElementToAnchoredElement=function(e,t){for(var n=t.childElementCount,a=0;a<n;a++){var i=t.children[a];if("BR"===i.tagName)return void t.insertBefore(e,i)}t.appendChild(e)},t._removeAnchorIcon=function(e,t){e.lastElementChild&&a._isElementAnchorIcon(e.lastElementChild)&&e.removeChild(e.lastElementChild)},t}return(0,t.__extends)(a,e),Object.defineProperty(a,"_anchorIconElement",{get:function(){if(!a._anchorIconElementCache){var e=document.createElement("i"),t=(0,f.css)("e_a_1310c973","f_a_1310c973");e.className=(0,f.css)(t,(0,f.getIconClassName)("Link")),e.setAttribute("aria-hidden","true"),a._anchorIconElementCache=document.createElement("a"),a._anchorIconElementCache.classList.add(S,"c_a_1310c973"),I()&&a._anchorIconElementCache.classList.add("g_a_1310c973"),a._anchorIconElementCache.appendChild(e)}return a._anchorIconElementCache.cloneNode(!0)},enumerable:!1,configurable:!0}),a._isElementAnchorIcon=function(e){return e.hasAttribute(p)&&e.classList.contains(S)},a._isInlineImageEnabled=function(){return n._BrowserDetection.getBrowserInformation().browser!==n._Browser.IE},a.prototype.componentDidMount=function(){this._registerAnchors()},a.prototype.componentDidUpdate=function(){this._registerAnchors(!0)},a.prototype.componentWillUnmount=function(){this._unregister(this.props.componentId)},a.prototype.render=function(){return a._isInlineImageEnabled()?(this.props.elementForSearch&&this._registerAnchors(!0),c.createElement(c.Fragment,null)):c.createElement("div",{className:n._SPKillSwitch.isActivated("e17386a1-e2f5-44c9-aa64-7d8510c36c26")?void 0:"a_a_1310c973",ref:this._resolveRef("_wrapperElement")},this.props.children)},a.prototype._registerAnchors=function(e){var t=this;void 0===e&&(e=!1);var n=a._isInlineImageEnabled()&&this.props.elementForSearch||this._wrapperElement;if(n){var i=[].slice.call(n.querySelectorAll(this.props.anchorElementSelector));this._register(this.props.componentId,e,i.map(function(e,n){var a=t.props.suggestAnchorId?t.props.suggestAnchorId(e,n):e.textContent||"";return{suggestedAnchorId:a,anchorTargetElement:e,onReceiveAnchorId:function(e,n){return t._addAnchorIcon(e,n,a)},onDisposeAnchorId:t._removeAnchorIcon}}))}},a.prototype._register=function(e,t,n){var a={action:t?"Refresh":"Register",uniqueId:e,anchorList:n};s.raiseAnchorEvent(a)},a.prototype._unregister=function(e){var t={action:"Unregister",uniqueId:e};s.raiseAnchorEvent(t)},a.prototype._dynamicallySetAnchorPosition=function(e,t,n){var a=(0,f.getRTL)();t.style.left="".concat(a?n.offsetLeft-t.offsetWidth-5:n.offsetLeft,"px"),t.style.top="".concat(n.offsetTop+e,"px")},a}(f.BaseComponent);function O(e){var t=e.anchorElementSelector,a=e.componentId,i=e.elementForSearch,r=e.onShow,o=e.suggestAnchorId;u().useEffect(function(){s.reserve(a)},[]);var c=u().useMemo(function(){return[].slice.call(i.querySelectorAll(t)).map(function(e){return[e,document.createElement(e.tagName)]})},[i,t]);u().useEffect(function(){return s.raiseAnchorEvent({action:"Register",uniqueId:a,anchorList:c.map(function(e,t){var a=e[0],i=e[1],s=o?o(a,t):a.textContent||"";return{suggestedAnchorId:s,anchorTargetElement:i,onReceiveAnchorId:function(e,t){var n=h(),a=n?null:e.querySelector("[".concat(p,'="').concat(t,'"]'));!n&&a||(a=document.createElement("a"),b(e,a,t,s),e.append(a))},onDisposeAnchorId:function(e,t){e.remove()},onScrollToAnchorId:function(e,t){null==r||r(),n._SPKillSwitch.isActivated("9a686da2-4aa5-4245-9623-3152af215d46")||requestAnimationFrame(function(){var e;null===(e=document.getElementById(t))||void 0===e||e.scrollIntoView()})}}})}),function(){s.raiseAnchorEvent({action:"Unregister",uniqueId:a})}},[o,a,s,c,r]);var d=u().useRef(void 0),l=u().useCallback(function(e){d.current&&c.forEach(function(e){return e[0],e[1].remove()}),e&&c.forEach(function(t){t[0];var n=t[1];return e.append(n)}),d.current=e},[c]);return u().createElement("div",{className:"h_b_1310c973",ref:l})}y.loadStyles(".h_b_1310c973{height:0}",!0)})(),l})());