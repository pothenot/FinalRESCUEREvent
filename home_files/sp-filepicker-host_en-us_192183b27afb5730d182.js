define("bc9242cf-c4f7-4ff8-a1f4-93ae4da35b7f_0.1.0",["tslib","react","@microsoft/sp-core-library","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@ms/odsp-core-bundle","@ms/office-ui-fabric-react-bundle","@ms/uifabric-styling-bundle","@microsoft/load-themed-styles","@ms/sp-fluentui-migration-spinner-bundle"],(e,t,n,a,i,r,o,s,c,d)=>(()=>{var l={440:(e,t,n)=>{var a=n(853);e.exports=a._Utilities}
,130:(e,t,n)=>{var a=n(853);e.exports=a._Utilities}
,622:(e,t,n)=>{var a=n(79);e.exports=a.workaround_Icon}
,979:(e,t,n)=>{var a=n(79);e.exports=a.workaround_Popup}
,475:(e,t,n)=>{var a=n(79);e.exports=a.workaround_ResponsiveModeIndex}
,230:e=>{"use strict";e.exports=c},878:e=>{"use strict";e.exports=n},377:e=>{"use strict";e.exports=i},362:e=>{"use strict";e.exports=r},79:e=>{"use strict";e.exports=o},962:e=>{"use strict";e.exports=a},785:e=>{"use strict";e.exports=d},853:e=>{"use strict";e.exports=s},650:e=>{"use strict";e.exports=t},553:t=>{"use strict";t.exports=e}},u={};function f(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return l[e](n,n.exports,f),n.exports}f.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return f.d(t,{a:t}),t},f.d=(e,t)=>{for(var n in t)f.o(t,n)&&!f.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},f.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};return(()=>{"use strict";f.r(p),f.d(p,{SPFilePickerHost:()=>je,SPFilePickerHostCallbacks:()=>Me,getCommandConfiguration:()=>Fe,getEntryConfiguration:()=>Pe,getFilePickerHostOptions:()=>Re,getListLayoutConfiguration:()=>Te,getPivotConfigurations:()=>He,getTypesAndSourcesConfiguraton:()=>Ue});var e=f(553),t=f(650),n=f.n(t);function a(e){var n=t.useRef(e);n.current=e;var a=t.useRef();return a.current||(a.current=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=n.current;return a.apply(null,e)})}var i=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}(),r=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),a=function(e,a){var r=e,o=r.dispose,s="function"==typeof o&&o.disposalChain||function(e){var t=new i(e),n=e.dispose,a=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=a,a.disposalChain=t,t}(r);return s.addCallback(function(){delete t._disposables[n]}),r}(e);return this._disposables[n]=a,a},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],i=e[a];i&&"function"==typeof i.dispose&&i.dispose(),delete e[a]}},e}(),o=function(){function e(e){this._scope=new r,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(s(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var r=this._disposableMap.get(e);r||(r=new Map,this._disposableMap.set(e,r));var o=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});r.set(t,o)},e.prototype.off=function(e,t,n){var a;if(s(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var r=this._disposableMap.get(e);if(r){var o=r.get(t);o&&(o.dispose(),r.delete(t)),0===r.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function s(e){return!!e.addEventListener}var c,d=function(){function e(e){this._scope=new r,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),l="handlerRejection",u="canceled",m=0,_=function(){function e(e,t){void 0===t&&(t={});var n=this,a=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},s=e.initResources,c=e.initTimeoutMs,f=void 0===c?1e4:c,p=e.ackTimeoutMs,m=void 0===p?1e3:p,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?d:b,v=t.eventGroupType,y=void 0===v?o:v,S=this._scope=new r;S.attach(s);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=m,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:l,isExpected:!1,message:"Unknown error"}).code||e.name||l,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=u,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(f,"ms"));e.code="setupTimeout",a(e)},f),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=a}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:u,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++m,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(h(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(h(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function h(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl"}(c||(c={}));var b=function(e,t){var n;void 0===e&&(e="");var a=null!==(n=null==t?void 0:t.allowDataUrl)&&void 0!==n&&n,i=e.indexOf("//"),r=e.indexOf("/"),o=i>-1&&i<=r?i+"//".length:-1,s=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,o),d=s&&s.slice(o),l=e.slice(s.length),u=s?c.absolute:a&&g.test(e)?c.dataUrl:"/"===l[0]?c.serverRelative:c.relative,f=l.split("/");this.authority=s,this.domain=d,this.format=u,this.path=l,this.segments=f,this.value=e},g=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;function v(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function y(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}var S=f(230);(0,S.loadStyles)([{rawString:".frame_610dbd83{border:none;display:block}"}]);var D,I,x=f(362),C=f(440),O=f(130),w=(D={},I=new WeakMap,Object.freeze(D),I.set(D,!0),!!I.get(D));function E(e){w&&(Object.isFrozen(e)||Object.freeze(e))}function A(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var L=new WeakMap,k=function(){function e(){this.isDelete=!0}return e.prototype.apply=function(){},e}(),M=function(){this.isPatch=!0};function P(e,t){return function(e){void 0===e&&(e={});var t=e.freeze,n=void 0!==t&&t,a=new Map,i=new Map;function r(e){return a.set(e,!0),e}return function(e){var t=e(function e(t,o){var s=a.get(t)?t:void 0;if(o){if(i.get(o))throw new Error("Encountered a circular reference in patch supplied to graft().");i.set(o,!0);for(var c=0,d=Object.keys(o);c<d.length;c++){var l=d[c],u=t[l],f=o[l];if(!A(f,u)){var p=void 0;if(f&&T(f)?p=f:f&&f instanceof M?p=f.apply(u,{graft:e,unlock:r}):f&&"object"==typeof f&&Object.getPrototypeOf(f)!==Object.prototype?p=f:f&&"object"==typeof f&&u&&"object"==typeof u?p=e(u,f):"object"==typeof f&&f&&U(f)?(p=e(r({}),f),n&&p&&"object"==typeof p&&!a.get(p)&&E(p)):p=f,!A(p,u)||!(l in t)){if(!s){s=r({});for(var m=0,_=Object.keys(t);m<_.length;m++){var h=_[m];s[h]=t[h]}}T(p)?delete s[l]:s[l]=p}}}i.delete(o)}var b=s||t;return b&&L.set(b,!1),b},{unlock:r});return n&&a.forEach(function(e,t){E(t)}),t}}()(function(n){return n(e,t)})}function T(e){return e instanceof k}function U(e){return F(e,{ancestors:new Map})}function F(e,t){var n=t.ancestors;if(n.get(e))throw new Error("Encountered circular reference in patch supplied to graft().");var a=L.get(e);if(void 0!==a)return a;n.set(e,!0);var i=!1;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=e[r];if(o&&o instanceof k){i=!0;break}if(o&&o instanceof M){i=!0;break}if(o&&"object"==typeof o&&Object.getPrototypeOf(o)===Object.prototype&&F(o,t)){i=!0;break}}return n.delete(e),L.set(e,i),i}function H(e,t){if(!A(e,t)){for(var n={},a=0,i=Object.keys(e);a<i.length;a++){var r=e[l=i[a]],o=t[l];if(l in t){if(!A(o,r))if("object"==typeof o&&o&&Object.getPrototypeOf(o)!==Object.prototype)n[l]=o;else if("object"==typeof o&&o&&"object"==typeof r&&r){var s=H(r,o);s&&Object.keys(s).length>0&&(n[l]=s)}else n[l]=o}else n[l]=new k}for(var c=0,d=Object.keys(t);c<d.length;c++){var l;(l=d[c])in e||(n[l]=t[l])}return n}}function R(t,n){var a=n instanceof Array?function(e,t,n){for(var a={},i=0,r=e;i<r.length;i++){a[r[i]]=!0}return a}(n):n,i=void 0;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(r in a||(i||(i=(0,e.__assign)({},t)),delete i[r]));return i||t}var N=f(79),B=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(B.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(B,Error));var j=function(t){function n(n){var a=t.call(this,n)||this;a.name="ApiError";var i=n.innerError||void 0,r=i?(0,e.__assign)((0,e.__assign)((0,e.__assign)((0,e.__assign)((0,e.__assign)({},"string"==typeof i.correlationId?{correlationId:i.correlationId}:{}),"boolean"==typeof i.isExpected?{isExpected:i.isExpected}:{}),"string"==typeof i.name?{code:i.name}:{}),"string"==typeof i.code?{code:i.code}:{}),"object"==typeof i.extraData?{extraData:i.extraData}:{}):{},o=n.correlationId,s=void 0===o?r.correlationId:o,c=n.isExpected,d=void 0===c?r.isExpected:c,l=n.extraData;return a.correlationId=s,a.isExpected=!!d,a.code=V(n.code)?n.code(r.code)||"":n.code||r.code||"",a.extraData=(0,e.__assign)((0,e.__assign)({},r.extraData||{}),l||{}),a}return(0,e.__extends)(n,t),n}(B);function V(e){return"function"==typeof e}var z="Canceled",G=function(t){function n(n){void 0===n&&(n={message:z});var a,i,r=this,o=function(e){return e||"Canceled"};return(r=t.call(this,(0,e.__assign)({code:V(n.code)?(a=n.code,i=o,function(e){return a(i(e))}):o,isExpected:!0},n))||this).name=z,r}return(0,e.__extends)(n,t),n}(j),K=x.KillSwitch.isActivated("0F8C524D-93DF-45F2-9CBB-64AED06517C5","08/11/2023","Normalize CorrelationId in QoS events");function W(t){var n,a,i=t||void 0;return(0,e.__assign)((0,e.__assign)({error:t&&(t.message||t.name),resultCode:i&&(n=i,a=[],"object"==typeof n.extraData&&n.extraData&&void 0!==n.extraData.status&&a.push("[".concat(n.extraData.status,"]")),"string"==typeof n.code&&a.push("".concat(n.code)),a.join(" "))||t&&t.name||"Unknown"},i?(0,e.__assign)({},"boolean"==typeof i.isExpected?{resultType:i.isExpected?x.ResultTypeEnum.ExpectedFailure:x.ResultTypeEnum.Failure}:{resultType:x.ResultTypeEnum.Failure}):{resultType:x.ResultTypeEnum.Success}),{extraData:(0,e.__assign)({stack:t&&t.stack},i?(0,e.__assign)((0,e.__assign)((0,e.__assign)({},"object"==typeof i.innerError?{innerError:W(i.innerError)}:{}),"string"==typeof i.correlationId?K?{correlationId:i.correlationId}:{CorrelationId:i.correlationId}:{}),"object"==typeof i.extraData?(0,e.__assign)({},i.extraData):{}):{})})}const q=JSON.parse('{"OL":"Pick a file||Pick files","UW":"1||2-","OQ":"Pick a folder||Pick folders","R8":"1||2-","uK":"Pick an item||Pick items","Hw":"1||2-"}');var Q=/\{(\d+)\}/g,Y={all:{pickerTitle:q.uK,pickerTitleIntervals:q.Hw},files:{pickerTitle:q.OL,pickerTitleIntervals:q.UW},folders:{pickerTitle:q.OQ,pickerTitleIntervals:q.R8}};function J(e){var t,n=e.title,a=e.selectionMode,i=e.itemMode;if(n)t=n;else{var r="multiple"===a?2:1,o=Y[i];t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(Q,function(e,n){var a=t[Number(n)];return null===a?"":"".concat(a)})}(function(e,t,n){if(n=Number(n),void 0===e||void 0===t||void 0===n)return"";for(var a="",i=-1,r=t.split("||"),o=0,s=r.length;o<s;o++){var c=r[o];if(c){for(var d=0,l=c.split(",");d<l.length;d++){var u=l[d];if(u)if(isNaN(Number(u))){if(-1!==u.indexOf("-")){var f=u.split("-");if(2!==f.length)continue;var p=void 0,m=void 0;if("*"===u[0]){var _=f[0].substring(1),h=f[1];if(isNaN(Number(_))||isNaN(Number(h)))continue;p=parseInt(_,10),m=parseInt(h,10);for(var b=void 0,g=p;g<=m;g++){var v="[0-9]*"+g;if(new RegExp("^".concat(v,"$")).test(n.toString())){b=!0;break}}if(b){i=o;break}}else{if(""===f[0])p=0;else{if(isNaN(Number(f[0])))continue;p=parseInt(f[0],10)}if(n>=p){if(""===f[1]){i=o;break}if(isNaN(Number(f[1])))continue;if(n<=(m=parseInt(f[1],10))){i=o;break}}}}else if(-1!==u.indexOf("*")&&(v=u.trim().replace(/\*/g,"[0-9]*"),new RegExp("^".concat(v,"$")).test(n.toString()))){i=o;break}}else if(n===parseInt(u,10)){i=o;break}}if(-1!==i)break}}if(-1!==i){var y=e.split("||");y[i]&&(a=y[i])}return a}(o.pickerTitle,o.pickerTitleIntervals,r)||"")}return t}var X=x.KillSwitch.isActivated("182B2FCC-2348-48AB-BFBE-04969610C5E1","10/18/2021","Split picker options across query-string and post-messaging"),Z=x.KillSwitch.isActivated("69FB175A-8186-4311-9045-F073BA0B6A87","10/27/2021","Propagate current theme to File Picker"),$=x.KillSwitch.isActivated("5850b1ff-7f81-4f54-be09-09ea5a28fa65","10/3/2023","Use safe theme (remove components property as it is non-serializable) for the picker"),ee=x.KillSwitch.isActivated("954b2984-a91a-4812-aa49-5fa1558bc9ca","04/09/2024","Allow passing styles for iframe element"),te=t.forwardRef(function(n,i){var s,c,d,l,u,f=n.options,p=n.pickerPageUrl,m=n.app,h=n.scenario,g=n.onCommand,S=n.onNotification,D=n.className,I=n.style,w=n.theme,E=n.getAuthToken,A=n.reloadOnEntry,L=t.useState(null),k=L[0],M=L[1],T=t.useRef(),U=t.useRef(),F=U.current||(U.current=new x.Qos({name:"Sdk80FilePickerHost.".concat(h,".load")})),N=t.useRef(null),B=t.useCallback(function(e){N.current=e,M(e&&e.contentWindow||null)},[]),V=t.useState(function(){return"filePicker-".concat(function(e){var t=[];t.push(v(8,e)),t.push(v(4,e));var n="4"+v(3,e);t.push(n);var a=v(4,e),i=parseInt(a[0],16);return i&=3,a=(i|=8).toString(16)+a.substr(1),t.push(a),t.push(v(12,e)),t.join("-")}())})[0],z=t.useMemo(function(){return(0,e.__assign)({sdk:"8.0",accessibility:{showFocusOnLoad:document.body.classList.contains(O.IsFocusVisibleClassName),enableFocusTrap:!0}},!Z&&w?{theme:$?w:ne(w)}:{})},[w]),K=t.useMemo(function(){return P(P(z,f||{}),{sdk:"8.0",messaging:(0,e.__assign)({origin:location.origin,channelId:V,identifyParent:!0},X?{}:{waitForConfiguration:!0})})},[f]),q=t.useMemo(function(){var t="string"==typeof K.theme?K.theme:function(t){return t?(0,e.__assign)((0,e.__assign)({isInverted:t.isInverted},t.palette?{palette:R(t.palette,["white"])}:{}),t.semanticColors?{semanticColors:R(t.semanticColors,["bodyBackground"])}:{}):t}(K.theme),n=X?K:(0,e.__assign)((0,e.__assign)({},R(K,["sdk","authentication","messaging","entry","accounts","teams","telemetry","views","offlineAccess"])),!Z&&t?{theme:t}:{}),a=new URL(window.location.href).searchParams.get("enableFeatures"),i=new URL(window.location.href).searchParams.get("disableFeatures");return"".concat(p,"?").concat(function(e,t,n){var a="",i=!0;for(var r in e){var o,s=e[r];i?i=!1:a+="&",o="object"==typeof s&&s&&s.uriValue?s.uriValue:y("".concat(s)),a+="".concat(r,"=").concat(o)}return a}((0,e.__assign)((0,e.__assign)((0,e.__assign)({},a?{enableFeatures:a}:{}),i?{disableFeatures:i}:{}),{app:m,scenario:h,filePicker:JSON.stringify(n)})))},[p]),Q=a(n.onPick),Y=a(n.onClose),te=a(n.onLoad),ae=a(function(e){if("page-loaded"===e.notification){var t=void 0,n=e.error;n&&(t=new j({code:n.code,message:n.message,isExpected:n.isExpected})),F.end(W(t)),te({error:t})}S&&S(e)}),ie=a(function(t){switch(t.command){case"pick":return(0,e.__awaiter)(void 0,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return F.end({resultType:x.ResultTypeEnum.Success}),[4,Q({items:t.items,keepSharing:t.keepSharing,saveAs:t.saveAs})];case 1:return e.sent(),[2,{result:"success"}]}})});case"close":return(0,e.__awaiter)(void 0,void 0,void 0,function(){var n,a;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return(n=t.error)&&(a=new j({code:n.code,message:n.message,isExpected:n.isExpected})),F.end(W(a)),[4,Y({error:a||T.current||new G({code:"Closed"})})];case 1:return e.sent(),[2,{result:"success"}]}})})}if(g)return g(t)}),re=t.useRef(!1),oe=t.useRef();t.useEffect(function(){var t;if(k){var n=new b(p).authority,a=location.origin===n;re.current=!0,null===(t=N.current)||void 0===t||t.setAttribute("aria-busy","true"),a&&!x.KillSwitch.isActivated("D0E5CB50-40A2-4B68-876D-EB9A5808DDBF")&&(window.__EMBED_HOST_OPTIONS||(window.__EMBED_HOST_OPTIONS={}),window.__EMBED_HOST_OPTIONS[V]=K);var i=function(e,t){void 0===t&&(t={});var n=e.channelId,a=e.onReinitialize,i=e.origin,s=e.receiver,c=void 0===s?window:s,d=e.source,l=e.identifyParent,u=t.eventGroupType,f=void 0===u?o:u,p=t.messengerType,m=void 0===p?_:p,h=new r,b=h.attach(new f(null));return new m({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var r;if(l&&d){var o=setInterval(function(){var e={type:"identify-parent",channelId:n};d.postMessage(e,i)},100);r=h.attach({dispose:function(){clearInterval(o)}})}var s=!1;b.on(c,"message",function(t){var o=t.data;if(t.origin===i&&(!d||t.source===d)&&o&&"object"==typeof o&&"initialize"===o.type&&o.channelId===n){if(r&&r.dispose(),a){if(s)return a(),void b.dispose();s=!0}else b.dispose();var c=o.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({initTimeoutMs:6e4,channelId:V,origin:n,onNotification:ae,onCommand:ie,identifyParent:!0,source:k});return oe.current=i,(0,e.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,r,o,s,c,d;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return E?[4,E({url:p})]:[3,2];case 1:return n=e.sent(),[3,3];case 2:n=void 0,e.label=3;case 3:return t=n,(a=k.document.createElement("form")).setAttribute("method","POST"),a.setAttribute("action",q),t&&((r=k.document.createElement("input")).setAttribute("type","hidden"),r.setAttribute("name","access_token"),r.setAttribute("value",t),a.appendChild(r)),k.document.body.appendChild(a),a.submit(),(null===(c=null===(s=null==f?void 0:f.accessibility)||void 0===s?void 0:s.trapFocusOnLoad)||void 0===c||c)&&N.current&&N.current.focus(),X?[3,6]:[4,i.ready];case 4:return e.sent(),o={command:"configure",filePicker:K||{}},[4,i.sendCommand(o)];case 5:e.sent(),e.label=6;case 6:return re.current=!1,null===(d=N.current)||void 0===d||d.setAttribute("aria-busy","false"),T.current=void 0,[2]}})}).catch(function(e){var t;re.current=!1,null===(t=N.current)||void 0===t||t.setAttribute("aria-busy","false"),T.current||(T.current=e),te&&te({error:e})}),function(){oe.current=void 0,i.dispose(),!x.KillSwitch.isActivated("D0E5CB50-40A2-4B68-876D-EB9A5808DDBF")&&a&&window.__EMBED_HOST_OPTIONS&&(delete window.__EMBED_HOST_OPTIONS[V],0===Object.keys(window.__EMBED_HOST_OPTIONS).length&&delete window.__EMBED_HOST_OPTIONS)}}},[k]),t.useImperativeHandle(i,function(){return{sendCommand:function(t,n){return(0,e.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,e.__generator)(this,function(e){return(a=oe.current)?[2,a.sendCommand(t,n)]:[2,{result:"error",isExpected:!1}]})})}}});var se=a(function(e){T.current||(T.current=new j({code:"UnableToLoadPickerFrame"}),te&&te({error:T.current}))}),ce=t.useRef(null!==(s=K.entry)&&void 0!==s?s:{});t.useEffect(function(){(0,e.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return!oe.current||re.current?[3,3]:(t={command:"configure",filePicker:K||{}},n=null!==(i=K.entry)&&void 0!==i?i:{},a=H(ce.current,n),ce.current=n,[4,oe.current.sendCommand(t)]);case 1:return e.sent(),A&&a&&Object.keys(a).length>0?[4,oe.current.sendCommand({command:"load-page"})]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})}).catch(function(){})},[K]);var de=null!==(d=null===(c=null==K?void 0:K.selection)||void 0===c?void 0:c.mode)&&void 0!==d?d:"single",le=null!==(u=null===(l=null==K?void 0:K.typesAndSources)||void 0===l?void 0:l.mode)&&void 0!==u?u:"files";return t.createElement("iframe",{"data-automationid":"filePickerFrame",ref:B,onError:se,title:J({title:K.title,selectionMode:de,itemMode:le}),className:(0,C.css)("frame_610dbd83",D),style:ee?void 0:I})});function ne(t){return t.components,(0,e.__rest)(t,["components"])}var ae=Z?te:(0,N.styled)(te,function(e){return{}}),ie=N.AnimationVariables.durationValue2,re={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},oe=f(979),se=f(475),ce=f(622),de=(0,N.memoizeFunction)(function(e,t){return{root:(0,N.mergeStyles)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),le=t.createContext({window:"object"==typeof window?window:void 0}),ue=function(e){var t,n;return(null!==(n=null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.document)&&void 0!==n?n:"undefined"!=typeof document)?document:void 0},fe={start:"touchstart",move:"touchmove",stop:"touchend"},pe={start:"mousedown",move:"mousemove",stop:"mouseup"},me=function(n){function a(e){var a=n.call(this,e)||this;return a._currentEventType=pe,a._events=[],a._onMouseDown=function(e){var n=t.Children.only(a.props.children).props.onMouseDown;return n&&n(e),a._currentEventType=pe,a._onDragStart(e)},a._onMouseUp=function(e){var n=t.Children.only(a.props.children).props.onMouseUp;return n&&n(e),a._currentEventType=pe,a._onDragStop(e)},a._onTouchStart=function(e){var n=t.Children.only(a.props.children).props.onTouchStart;return n&&n(e),a._currentEventType=fe,a._onDragStart(e)},a._onTouchEnd=function(e){var n=t.Children.only(a.props.children).props.onTouchEnd;n&&n(e),a._currentEventType=fe,a._onDragStop(e)},a._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(a.props.handleSelector&&!a._matchesSelector(e.target,a.props.handleSelector)||a.props.preventDragSelector&&a._matchesSelector(e.target,a.props.preventDragSelector))){a._touchId=a._getTouchId(e);var t=a._getControlPosition(e);if(void 0!==t){var n=a._createDragDataFromPosition(t);a.props.onStart&&a.props.onStart(e,n),a.setState({isDragging:!0,lastPosition:t});var i=ue(a.context);a._events=[(0,N.on)(i.body,a._currentEventType.move,a._onDrag,!0),(0,N.on)(i.body,a._currentEventType.stop,a._onDragStop,!0)]}}},a._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=a._getControlPosition(e);if(t){var n=a._createUpdatedDragData(a._createDragDataFromPosition(t)),i=n.position;a.props.onDragChange&&a.props.onDragChange(e,n),a.setState({position:i,lastPosition:t})}},a._onDragStop=function(e){if(a.state.isDragging){var t=a._getControlPosition(e);if(t){var n=a._createDragDataFromPosition(t);a.setState({isDragging:!1,lastPosition:void 0}),a.props.onStop&&a.props.onStop(e,n),a.props.position&&a.setState({position:a.props.position}),a._events.forEach(function(e){return e()})}}},a.state={isDragging:!1,position:a.props.position||{x:0,y:0},lastPosition:void 0},a}return(0,e.__extends)(a,n),a.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},a.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},a.prototype.render=function(){var n=t.Children.only(this.props.children),a=n.props,i=this.props.position,r=this.state,o=r.position,s=r.isDragging,c=o.x,d=o.y;return i&&!s&&(c=i.x,d=i.y),t.cloneElement(n,{style:(0,e.__assign)((0,e.__assign)({},a.style),{transform:"translate(".concat(c,"px, ").concat(d,"px)")}),className:de(a.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},a.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},a.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},a.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},a.prototype._matchesSelector=function(e,t){var n;if(!e||e===(null===(n=ue(this.context))||void 0===n?void 0:n.body))return!1;var a=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!a&&(a.call(e,t)||this._matchesSelector(e.parentElement,t))},a.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},a.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},a.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},a.contextType=le,a}(t.Component);function _e(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=t.useCallback(function(e){i.current=e;for(var t=0,a=n;t<a.length;t++){var r=a[t];"function"==typeof r?r(e):r&&(r.current=e)}},(0,e.__spreadArray)([],n,!0));return i}function he(e){var n=t.useRef();return void 0===n.current&&(n.current={value:"function"==typeof e?e():e}),n.current.value}var be=function(){var e=he({});return t.useEffect(function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];clearTimeout(a)}}},[e]),he({setTimeout:function(t,n){var a=setTimeout(t,n);return e[a]=1,a},clearTimeout:function(t){delete e[t],clearTimeout(t)}})},ge={x:0,y:0},ve={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},ye=(0,N.classNamesFunction)(),Se=t.forwardRef(function(n,a){var i,r,o,s,c,d,l,u=(0,N.getPropsWithDefaults)(ve,n),f=u.allowTouchBodyScroll,p=u.className,m=u.children,_=u.containerClassName,h=u.scrollableContentClassName,b=u.elementToFocusOnDismiss,g=u.firstFocusableSelector,v=u.focusTrapZoneProps,y=u.forceFocusInsideTrap,S=u.disableRestoreFocus,D=void 0===S?u.ignoreExternalFocusing:S,I=u.isBlocking,x=u.isAlert,C=u.isClickableOutsideFocusTrap,w=u.isDarkOverlay,E=u.onDismiss,A=u.layerProps,L=u.overlay,k=u.isOpen,M=u.titleAriaId,P=u.styles,T=u.subtitleAriaId,U=u.theme,F=u.topOffsetFixed,H=u.responsiveMode,R=u.onLayerDidMount,B=u.isModeless,j=u.dragOptions,V=u.onDismissed,z=u.enableAriaHiddenSiblings,G=u.popupProps,K=t.useRef(null),W=t.useRef(null),q=_e(W,null==v?void 0:v.componentRef),Q=t.useRef(null),Y=_e(K,a),J=(0,se.useResponsiveMode)(Y),X=function(e,n){var a=t.useRef(n);return a.current||(a.current=(0,O.getId)("ModalFocusTrapZone")),a.current}(0,null==v?void 0:v.id),Z=t.useContext(le).window,$=be(),ee=$.setTimeout,te=$.clearTimeout,ne=t.useState(k),ae=ne[0],re=ne[1],de=t.useState(k),ue=de[0],fe=de[1],pe=t.useState(ge),Se=pe[0],De=pe[1],Ie=t.useState(),xe=Ie[0],Ce=Ie[1],Oe=function(e){var n=t.useState(!1),a=n[0],i=n[1];return[a,{setTrue:he(function(){return function(){i(!0)}}),setFalse:he(function(){return function(){i(!1)}}),toggle:he(function(){return function(){i(function(e){return!e})}})}]}(),we=Oe[0],Ee=Oe[1],Ae=Ee.toggle,Le=Ee.setFalse,ke=he(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:f,scrollableContent:null,lastSetCoordinates:ge,events:new N.EventGroup({})}}),Me=(j||{}).keepInBounds,Pe=null!=x?x:I&&!B,Te=void 0===A?"":A.className,Ue=ye(P,{theme:U,className:p,containerClassName:_,scrollableContentClassName:h,isOpen:k,isVisible:ue,hasBeenOpened:ke.hasBeenOpened,modalRectangleTop:xe,topOffsetFixed:F,isModeless:B,layerClassName:Te,windowInnerHeight:null==Z?void 0:Z.innerHeight,isDefaultDragHandle:j&&!j.dragHandleSelector}),Fe=(0,e.__assign)((0,e.__assign)({eventBubblingEnabled:!1},A),{onLayerDidMount:A&&A.onLayerDidMount?A.onLayerDidMount:R,insertFirst:(null==A?void 0:A.insertFirst)||B,className:Ue.layer}),He=t.useCallback(function(e){e?ke.allowTouchBodyScroll?(0,N.allowOverscrollOnElement)(e,ke.events):(0,N.allowScrollOnElement)(e,ke.events):ke.events.off(ke.scrollableContent),ke.scrollableContent=e},[ke]),Re=function(){var e=Q.current,t=null==e?void 0:e.getBoundingClientRect();t&&(F&&Ce(t.top),Me&&(ke.minPosition={x:-t.left,y:-t.top},ke.maxPosition={x:t.left,y:t.top}))},Ne=t.useCallback(function(e,t){var n=ke.minPosition,a=ke.maxPosition;return Me&&n&&a&&(t=Math.max(n[e],t),t=Math.min(a[e],t)),t},[Me,ke]),Be=function(){var e;ke.lastSetCoordinates=ge,Le(),ke.isInKeyboardMoveMode=!1,re(!1),De(ge),null===(e=ke.disposeOnKeyUp)||void 0===e||e.call(ke),null==V||V()},je=t.useCallback(function(){Le(),ke.isInKeyboardMoveMode=!1},[ke,Le]),Ve=t.useCallback(function(e,t){De(function(e){return{x:Ne("x",e.x+t.delta.x),y:Ne("y",e.y+t.delta.y)}})},[Ne]),ze=t.useCallback(function(){W.current&&W.current.focus()},[]);t.useEffect(function(){var e;te(ke.onModalCloseTimer),k&&(requestAnimationFrame(function(){return ee(Re,0)}),re(!0),j&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===N.KeyCodes.space&&(0,N.elementContains)(ke.scrollableContent,e.target)&&(Ae(),e.preventDefault(),e.stopPropagation())},ke.disposeOnKeyUp||(ke.events.on(Z,"keyup",e,!0),ke.disposeOnKeyUp=function(){ke.events.off(Z,"keyup",e,!0),ke.disposeOnKeyUp=void 0})),ke.hasBeenOpened=!0,fe(!0)),!k&&ae&&(ke.onModalCloseTimer=ee(Be,1e3*parseFloat(ie)),fe(!1))},[ae,k]),d=function(){ke.events.dispose()},(l=t.useRef(d)).current=d,t.useEffect(function(){return function(){var e;null===(e=l.current)||void 0===e||e.call(l)}},[]),function(e,n){t.useImperativeHandle(e.componentRef,function(){return{focus:function(){n.current&&n.current.focus()}}},[n])}(u,W);var Ge=t.createElement(N.FocusTrapZone,(0,e.__assign)({},v,{id:X,ref:Q,componentRef:q,className:(0,N.css)(Ue.main,null==v?void 0:v.className),elementToFocusOnDismiss:null!==(i=null==v?void 0:v.elementToFocusOnDismiss)&&void 0!==i?i:b,isClickableOutsideFocusTrap:null!==(r=null==v?void 0:v.isClickableOutsideFocusTrap)&&void 0!==r?r:B||C||!I,disableRestoreFocus:null!==(o=null==v?void 0:v.disableRestoreFocus)&&void 0!==o?o:D,forceFocusInsideTrap:(null!==(s=null==v?void 0:v.forceFocusInsideTrap)&&void 0!==s?s:y)&&!B,firstFocusableSelector:(null==v?void 0:v.firstFocusableSelector)||g,focusPreviouslyFocusedInnerElement:null===(c=null==v?void 0:v.focusPreviouslyFocusedInnerElement)||void 0===c||c,onBlur:ke.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==v?void 0:v.onBlur)||void 0===t||t.call(v,e),ke.lastSetCoordinates=ge,ke.isInKeyboardMoveMode=!1,null===(n=ke.disposeOnKeyDown)||void 0===n||n.call(ke)}:void 0}),j&&ke.isInKeyboardMoveMode&&t.createElement("div",{className:Ue.keyboardMoveIconContainer},j.keyboardMoveIconProps?t.createElement(ce.Icon,(0,e.__assign)({},j.keyboardMoveIconProps)):t.createElement(ce.Icon,{iconName:"move",className:Ue.keyboardMoveIcon})),t.createElement("div",{ref:He,className:Ue.scrollableContent,"data-is-scrollable":!0},j&&we&&t.createElement(j.menu,{items:[{key:"move",text:j.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===N.KeyCodes.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===N.KeyCodes.escape;if(we&&t&&Le(),!ke.isInKeyboardMoveMode||e.keyCode!==N.KeyCodes.escape&&e.keyCode!==N.KeyCodes.enter||(ke.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),ke.isInKeyboardMoveMode){var n=!0,a=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t}(e);switch(e.keyCode){case N.KeyCodes.escape:De(ke.lastSetCoordinates);case N.KeyCodes.enter:ke.lastSetCoordinates=ge;break;case N.KeyCodes.up:De(function(e){return{x:e.x,y:Ne("y",e.y-a)}});break;case N.KeyCodes.down:De(function(e){return{x:e.x,y:Ne("y",e.y+a)}});break;case N.KeyCodes.left:De(function(e){return{x:Ne("x",e.x-a),y:e.y}});break;case N.KeyCodes.right:De(function(e){return{x:Ne("x",e.x+a),y:e.y}});break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}};ke.lastSetCoordinates=Se,Le(),ke.isInKeyboardMoveMode=!0,ke.events.on(Z,"keydown",e,!0),ke.disposeOnKeyDown=function(){ke.events.off(Z,"keydown",e,!0),ke.disposeOnKeyDown=void 0}}},{key:"close",text:j.closeMenuItemText,onClick:Be}],onDismiss:Le,alignTargetEdge:!0,coverTarget:!0,directionalHint:N.DirectionalHint.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:ke.scrollableContent}),m));return ae&&J>=(H||se.ResponsiveMode.small)&&t.createElement(N.Layer,(0,e.__assign)({ref:Y},Fe),t.createElement(oe.Popup,(0,e.__assign)({role:Pe?"alertdialog":"dialog",ariaLabelledBy:M,ariaDescribedBy:T,onDismiss:E,shouldRestoreFocus:!D,enableAriaHiddenSiblings:z,"aria-modal":!B},G),t.createElement("div",{className:Ue.root,role:B?void 0:"document"},!B&&t.createElement(N.Overlay,(0,e.__assign)({"aria-hidden":!0,isDarkThemed:w,onClick:I?void 0:E,allowTouchBodyScroll:f},L)),j?t.createElement(me,{handleSelector:j.dragHandleSelector||"#".concat(X),preventDragSelector:"button",onStart:je,onDragChange:Ve,onStop:ze,position:Se},Ge):Ge)))||null});Se.displayName="Modal";var De,Ie=(0,N.styled)(Se,function(e){var t,n=e.className,a=e.containerClassName,i=e.scrollableContentClassName,r=e.isOpen,o=e.isVisible,s=e.hasBeenOpened,c=e.modalRectangleTop,d=e.theme,l=e.topOffsetFixed,u=e.isModeless,f=e.layerClassName,p=e.isDefaultDragHandle,m=e.windowInnerHeight,_=d.palette,h=d.effects,b=d.fonts,g=(0,N.getGlobalClassNames)(re,d);return{root:[g.root,b.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity ".concat(ie)},l&&"number"==typeof c&&s&&{alignItems:"flex-start"},r&&g.isOpen,o&&{opacity:1},o&&!u&&{pointerEvents:"auto"},n],main:[g.main,{boxShadow:h.elevation64,borderRadius:h.roundedCorner2,backgroundColor:_.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:u?N.ZIndexes.Layer:void 0},u&&{pointerEvents:"auto"},l&&"number"==typeof c&&s&&{top:c},p&&{cursor:"move"},a],scrollableContent:[g.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:m},t)},i],layer:u&&[f,g.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:b.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});Ie.displayName="Modal";var xe=((De={})[se.ResponsiveMode.small]="sm",De[se.ResponsiveMode.medium]="md",De[se.ResponsiveMode.large]="lg",De[se.ResponsiveMode.xLarge]="xlg",De[se.ResponsiveMode.xxLarge]="xxlg",De[se.ResponsiveMode.xxxLarge]="xxxlg",De[se.ResponsiveMode.unknown]="",De);(0,S.loadStyles)([{rawString:".frame_a755d0de{width:1080px;height:680px;max-width:100%;max-height:100%}.spinnerHost_a755d0de{position:absolute;top:0;left:0;bottom:0;right:0;display:flex;justify-content:center;align-items:center;transition:opacity linear .3s 0s,visibility linear 0s 0s;background-color:"},{theme:"bodyBackground",defaultValue:"#fff"},{rawString:"}.spinnerHost_a755d0de.loaded_a755d0de{visibility:hidden;opacity:0;transition-delay:0s,0.3s}"}]);var Ce,Oe,we=f(785),Ee=x.KillSwitch.isActivated("B7BDF862-7031-4B0A-AC86-FB7D4FAB4BA6","2/24/2021","Make Picker modal once loaded"),Ae=x.KillSwitch.isActivated("8907F6FD-B9E5-47A8-B133-A450AFEBD3E6","05/13/2022","Add a loading spinner to the File Picker host"),Le=(Ce=ae,Oe=(0,se.withResponsiveMode)(function(n){var i,r=this,o=n.onClose,s=n.onLoad,c=n.className,d=n.responsiveMode,l=void 0===d?se.ResponsiveMode.large:d,u=(0,e.__rest)(n,["onClose","onLoad","className","responsiveMode"]),f=t.useReducer(function(e){return e+1},0)[1],p=t.useRef(),m=t.useRef(),_=a(function(e){m.current=e.error,p.current=!0,f(),s&&s(e)}),h=xe[l],b=a(function(){return(0,e.__awaiter)(r,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return o?[4,o({error:m.current||new G({code:"Dismissed"})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),g=t.useMemo(function(){return t.createElement(Ce,(0,e.__assign)({},u,{onLoad:_,onClose:o,className:(0,C.css)("frame_a755d0de",h,c)}))},[u,_,o,h,c]);return t.createElement(Ie,{isOpen:!0,onDismiss:!p.current||m.current||Ee?b:void 0,styles:{main:{display:"flex",borderRadius:"6px"}}},g,Ae?null:t.createElement("div",{className:(0,C.css)("spinnerHost_a755d0de",(i={},i.loaded_a755d0de=!!p.current,i)),role:"presentation"},t.createElement(we.Spinner,null)))}),function(n){return t.createElement(Oe,(0,e.__assign)({},n))}),ke=f(878),Me=function(){function e(e){var t=this;this.onPickCallback=function(e){return t._handlePick(e.items).catch(function(e){})},this.onCommandCallback=function(e){switch(e.command){case"pick-local-files":return n=e.files.map(function(e){return{src:"",file:e}}),t._props.handlePick({localFilesPickedToUpload:n,selectedItems:[]}).then(function(){return Promise.resolve({result:"success"})});case"pick":return t._handlePick(e.items).then(function(){return Promise.resolve({result:"success"})});case"close":return t._props.handleCancel().then(function(){return Promise.resolve({result:"success"})});default:return}var n},this.onNotificationCallback=function(e){"page-loaded"===e.notification&&t._props.handleLoaded()},this._props={handlePick:e.handlePick,handleLoaded:e.handleLoaded,handleCancel:e.handleCancel}}return e.prototype._handlePick=function(e){var t,n=[],a=[];return(null===(t=e[0].sharepointIds)||void 0===t?void 0:t.listItemUniqueId)?n=e.map(function(e){var t=e.sharepointIds,n=e.webUrl,a=e.webDavUrl;return{WebId:null==t?void 0:t.webId,SiteId:null==t?void 0:t.siteId,UniqueId:null==t?void 0:t.listItemUniqueId,ListId:null==t?void 0:t.listId,Link:a||n,ServerAbsoluteUrl:a||n}}):a=e.map(function(e){e.sharepointIds;var t=e.webUrl;return{src:e.webDavUrl||t,name:e.name||"",id:ke.Guid.newGuid().toString()}}),this._props.handlePick({selectedItems:n,externalImagesPickedToUpload:a})},e}();function Pe(e){return{sharePoint:{byPath:{web:e}},site:{}}}function Te(e){return{layout:{type:e}}}function Ue(t,n,a){return{mode:a,filters:n,pivots:(0,e.__assign)({},t)}}function Fe(e,t){return{browseThisDevice:{enabled:e,label:"Upload"},fromALink:{enabled:t,mode:"pivot"}}}function He(e){return{site:{byPath:{web:e}}}}function Re(e,t,n,a,i,r){return{entry:e,telemetry:{sessionId:"8afac8ce-5062-4eb0-b605-d4b726641b46"},typesAndSources:t,list:n,commands:a,pivots:i,selection:r}}var Ne=f(962),Be=f(377);function je(t){var a=n().useMemo(function(){var n="".concat(t.siteUrl,"/_layouts/15/FilePicker.aspx?"),a=(0,Ne.isControlHostCommunicatorForCoAuthEnabled)()?t.serviceScope.consume(Ne.ControlHostCommunicatorEdit.serviceKey):void 0,i=function(){if(null==a||a.notifyNonDataChangingEdit(),!ke._SPKillSwitch.isActivated("0936c604-c709-4a1d-8961-d48497d58ffa")){var e={app:t.app,scenario:t.scenario},n=new Be._LogEntry("SPFilePickerHost","Open",Be._LogType.Event,e);Be._EngagementLogger.logEventWithLogEntry(n)}},r=new Me((0,e.__assign)({handleLoaded:i},t));return{pickerPageUrl:n,app:t.app,scenario:t.scenario,onPick:function(e){var t;return(0,Ne.isControlHostCommunicatorForCoAuthEnabled)()&&(null==a||a.notifyNonDataChangingEditEnded()),null===(t=r.onPickCallback)||void 0===t?void 0:t.call(r,e)},onClose:function(){return null==a||a.notifyNonDataChangingEditEnded(),Promise.resolve(t.handleCancel())},onLoad:i,onCommand:r.onCommandCallback,onNotification:r.onNotificationCallback,options:Ve(t)}},[]);return n().createElement(n().Fragment,null,t.show&&n().createElement(Le,(0,e.__assign)({},a)))}function Ve(t){var n=t.siteUrl,a=t.selectMode,i=t.disableUpload,r=t.disableStockAssets,o=t.disableWebSearch,s=t.itemTypeExtensions,c=t.disableOneDrive,d=t.disableRecents,l=t.disableSite,u=t.disableMyOrganization,f=t.disableSharedLibraries,p=t.itemTypes,m=void 0===p?["photo"]:p,_=t.selectType,h=void 0===_?"files":_,b=Pe(n),g=Te("tiles"),v=Ue({stockImages:!r,bing:!o,myOrganization:!u,sharedLibraries:!f,shared:!1,site:!l,oneDrive:!c,recent:!d},s?(0,e.__spreadArray)((0,e.__spreadArray)([],m,!0),s,!0):m,h),y=He(n),S=Fe(!i,!0),D=function(e){return{mode:e}}(null!=a?a:"single");return Re(b,v,g,S,y,D)}})(),p})());